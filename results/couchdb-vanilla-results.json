{"platform":{"name":"centos","release":"7.8.2003"},"profiles":[{"name":"tests from {:path=>\"C:.Users.zhangc.git.apache-couchdb-srg-baseline.controls\"}","sha256":"5d7700288a6dee8fd9132bd80e48db914881a02b2cadeb53834e5d80de1e9d8f","title":"tests from {:path=>\"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls\"}","supports":[],"attributes":[{"name":"couchdb_conf_local","options":{"value":"/opt/couchdb/etc/local.ini"}},{"name":"couchdb_conf_default","options":{"value":"/opt/couchdb/etc/default.ini"}},{"name":"couchdb_owner","options":{"value":"couchdb"}},{"name":"couchdb_group","options":{"value":"couchdb"}},{"name":"couchdb_version","options":{"value":"3.1.0"}},{"name":"sys_admin","options":{"value":["root "]}},{"name":"couchdb_syslog_facility","options":{"value":["local0"]}},{"name":"couchdb_host","options":{"value":""}},{"name":"login_user","options":{"value":""}},{"name":"couchdb_dba","options":{"value":""}},{"name":"couchdb_db","options":{"value":"test_db"}},{"name":"couchdb_admin","options":{"value":"admin"}},{"name":"couchdb_adminpass","options":{"value":"mysecretpassword"}},{"name":"couch_host","options":{"value":"127.0.0.1"}},{"name":"couch_port","options":{"value":"5984"}},{"name":"approved_users","options":{"value":["couchdba","admin","couch_user"]}},{"name":"approved_admin","options":{"value":["couchdba","admin"]}},{"name":"approved_packages","options":{"value":[""]}},{"name":"couchdbpem","options":{"value":"/etc/couchdb/cert/couchdb.pem"}},{"name":"privkeypem","options":{"value":"/etc/couchdb/cert/privkey.pem"}},{"name":"authorized_ports","options":{"value":["80","443"]}},{"name":"couchdb_dba_password","options":{"value":"Input 'couchdb_dba_password' does not have a value. Skipping test."}}],"groups":[{"id":"V-32203.rb","controls":["V-32203"]},{"id":"V-32412.rb","controls":["V-32412"]},{"id":"V-32415.rb","controls":["V-32415"]},{"id":"V-32426.rb","controls":["V-32426"]},{"id":"V-32468.rb","controls":["V-32468"]},{"id":"V-32469.rb","controls":["V-32469"]},{"id":"V-32475.rb","controls":["V-32475"]},{"id":"V-32476.rb","controls":["V-32476"]},{"id":"V-32480.rb","controls":["V-32480"]},{"id":"V-32523.rb","controls":["V-32523"]},{"id":"V-32536.rb","controls":["V-32536"]},{"id":"V-58049.rb","controls":["V-58049"]},{"id":"V-58051.rb","controls":["V-58051"]},{"id":"V-58055.rb","controls":["V-58055"]},{"id":"V-58059.rb","controls":["V-58059"]},{"id":"V-58063.rb","controls":["V-58063"]},{"id":"V-58065.rb","controls":["V-58065"]},{"id":"V-58123.rb","controls":["V-58123"]},{"id":"V-58125.rb","controls":["V-58125"]},{"id":"V-58127.rb","controls":["V-58127"]},{"id":"V-58129.rb","controls":["V-58129"]},{"id":"V-58133.rb","controls":["V-58133"]},{"id":"V-58135.rb","controls":["V-58135"]},{"id":"V-58137.rb","controls":["V-58137"]},{"id":"V-58149.rb","controls":["V-58149"]},{"id":"V-58151.rb","controls":["V-58151"]},{"id":"V-58153.rb","controls":["V-58153"]},{"id":"V-58155.rb","controls":["V-58155"]},{"id":"V-58157.rb","controls":["V-58157"]},{"id":"V-58161.rb","controls":["V-58161"]},{"id":"V-58163.rb","controls":["V-58163"]},{"id":"V-58165.rb","controls":["V-58165"]},{"id":"V-58167.rb","controls":["V-58167"]},{"id":"V-58175.rb","controls":["V-58175"]},{"id":"V-58177.rb","controls":["V-58177"]},{"id":"V-58183.rb","controls":["V-58183"]},{"id":"V-61407.rb","controls":["V-61407"]}],"controls":[{"id":"V-32203","title":"The DBMS must enforce approved authorizations for logical access to\ninformation and system resources in accordance with applicable access control\npolicies.","desc":"Authentication with a DoD-approved PKI certificate does not\nnecessarily imply authorization to access the DBMS.  To mitigate the risk of\nunauthorized access to sensitive information by entities that have been issued\ncertificates by DoD-approved PKIs, all DoD systems, including databases, must\nbe properly configured to implement access control policies.\n\n    Successful authentication must not automatically give an entity access to\nan asset or security boundary. Authorization procedures and controls must be\nimplemented to ensure each authenticated entity also has a validated and\ncurrent authorization. Authorization is the process of determining whether an\nentity, once authenticated, is permitted to access a specific asset.\nInformation systems use access control policies and enforcement mechanisms to\nimplement this requirement.\n\n    Access control policies include identity-based policies, role-based\npolicies, and attribute-based policies. Access enforcement mechanisms include\naccess control lists, access control matrices, and cryptography. These policies\nand mechanisms must be employed by the application to control access between\nusers (or processes acting on behalf of users) and objects (e.g., devices,\nfiles, records, processes, programs, and domains) in the information system.\n\n    This requirement is applicable to access control enforcement applications,\na category that includes database management systems.  If the DBMS does not\nfollow applicable policy when approving access, it may be in conflict with\nnetworks or other applications in the information system. This may result in\nusers either gaining or being denied access inappropriately and in conflict\nwith applicable policy.","descriptions":[{"label":"default","data":"Authentication with a DoD-approved PKI certificate does not\nnecessarily imply authorization to access the DBMS.  To mitigate the risk of\nunauthorized access to sensitive information by entities that have been issued\ncertificates by DoD-approved PKIs, all DoD systems, including databases, must\nbe properly configured to implement access control policies.\n\n    Successful authentication must not automatically give an entity access to\nan asset or security boundary. Authorization procedures and controls must be\nimplemented to ensure each authenticated entity also has a validated and\ncurrent authorization. Authorization is the process of determining whether an\nentity, once authenticated, is permitted to access a specific asset.\nInformation systems use access control policies and enforcement mechanisms to\nimplement this requirement.\n\n    Access control policies include identity-based policies, role-based\npolicies, and attribute-based policies. Access enforcement mechanisms include\naccess control lists, access control matrices, and cryptography. These policies\nand mechanisms must be employed by the application to control access between\nusers (or processes acting on behalf of users) and objects (e.g., devices,\nfiles, records, processes, programs, and domains) in the information system.\n\n    This requirement is applicable to access control enforcement applications,\na category that includes database management systems.  If the DBMS does not\nfollow applicable policy when approving access, it may be in conflict with\nnetworks or other applications in the information system. This may result in\nusers either gaining or being denied access inappropriately and in conflict\nwith applicable policy."},{"label":"check","data":"From the system security plan or equivalent documentation, determine the\nappropriate permissions on database objects for each kind (group role) of user.\nIf this documentation is missing, this is a finding.\n\n    Check the permissions of all databases.\n    #GET /{db}/_security\n    Review all roles and their associated privileges. If any roles' privileges\nexceed those documented, this is a finding.\n\n\n    Review all entries and their associated authentication methods. If any\nentries do not have their documented authentication requirements, this is a\nfinding."},{"label":"fix","data":"Use the following command to set security objects correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\"admins\":{\"names\":[\"superuser\"],\"roles\":[\"admins\"]},\"members\":{\"names\":\n[\"user1\",\"user2\"],\"roles\": [\"developers\"]}}'"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000033-DB-000084","gid":"V-32203","rid":"SV-42520r3_rule","stig_id":"SRG-APP-000033-DB-000084","fix_id":null,"cci":["CCI-000213"],"nist":["AC-3","Rev_4"]},"code":"control \"V-32203\" do\n  title \"The DBMS must enforce approved authorizations for logical access to\ninformation and system resources in accordance with applicable access control\npolicies.\"\n  desc  \"Authentication with a DoD-approved PKI certificate does not\nnecessarily imply authorization to access the DBMS.  To mitigate the risk of\nunauthorized access to sensitive information by entities that have been issued\ncertificates by DoD-approved PKIs, all DoD systems, including databases, must\nbe properly configured to implement access control policies.\n\n    Successful authentication must not automatically give an entity access to\nan asset or security boundary. Authorization procedures and controls must be\nimplemented to ensure each authenticated entity also has a validated and\ncurrent authorization. Authorization is the process of determining whether an\nentity, once authenticated, is permitted to access a specific asset.\nInformation systems use access control policies and enforcement mechanisms to\nimplement this requirement.\n\n    Access control policies include identity-based policies, role-based\npolicies, and attribute-based policies. Access enforcement mechanisms include\naccess control lists, access control matrices, and cryptography. These policies\nand mechanisms must be employed by the application to control access between\nusers (or processes acting on behalf of users) and objects (e.g., devices,\nfiles, records, processes, programs, and domains) in the information system.\n\n    This requirement is applicable to access control enforcement applications,\na category that includes database management systems.  If the DBMS does not\nfollow applicable policy when approving access, it may be in conflict with\nnetworks or other applications in the information system. This may result in\nusers either gaining or being denied access inappropriately and in conflict\nwith applicable policy.\n  \"\n  desc  \"check\", \"\n    From the system security plan or equivalent documentation, determine the\nappropriate permissions on database objects for each kind (group role) of user.\nIf this documentation is missing, this is a finding.\n\n    Check the permissions of all databases.\n    #GET /{db}/_security\n    Review all roles and their associated privileges. If any roles' privileges\nexceed those documented, this is a finding.\n\n\n    Review all entries and their associated authentication methods. If any\nentries do not have their documented authentication requirements, this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Use the following command to set security objects correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\\\"admins\\\":{\\\"names\\\":[\\\"superuser\\\"],\\\"roles\\\":[\\\"admins\\\"]},\\\"members\\\":{\\\"names\\\":\n[\\\"user1\\\",\\\"user2\\\"],\\\"roles\\\": [\\\"developers\\\"]}}'\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000033-DB-000084\"\n  tag \"gid\": \"V-32203\"\n  tag \"rid\": \"SV-42520r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000033-DB-000084\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000213\"]\n  tag \"nist\": [\"AC-3\", \"Rev_4\"]\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32203.rb"},"waiver_data":{},"results":[]},{"id":"V-32412","title":"Database objects (including but not limited to tables, indexes,\nstorage, stored procedures, functions, triggers, links to software external to\nthe DBMS, etc.) must be owned by database/DBMS principals authorized for\nownership.","desc":"Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed.","descriptions":[{"label":"default","data":"Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed."},{"label":"check","data":"Review system documentation to identify accounts authorized to own database\nobjects. Review accounts that own objects in the database(s).\n\n    If any database objects are found to be owned by users not authorized to\nown database objects, this is a finding.\n    Check for the following:\n\n    Execute the command\n     #GET /db/_security\n    #grep names and verify that all users are authorized to own\ndatabase objects."},{"label":"fix","data":"Assign ownership of authorized objects to authorized object owner accounts.\nUse the following command to set privileges correctly:\n\n# PUT /{db}/_security"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000133-DB-000200","gid":"V-32412","rid":"SV-42749r3_rule","stig_id":"SRG-APP-000133-DB-000200","fix_id":null,"cci":["CCI-001499"],"nist":["CM-5 (6)","Rev_4"]},"code":"control \"V-32412\" do\n  title \"Database objects (including but not limited to tables, indexes,\nstorage, stored procedures, functions, triggers, links to software external to\nthe DBMS, etc.) must be owned by database/DBMS principals authorized for\nownership.\"\n  desc  \"Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed.\n  \"\n  desc  \"check\", \"\n    Review system documentation to identify accounts authorized to own database\nobjects. Review accounts that own objects in the database(s).\n\n    If any database objects are found to be owned by users not authorized to\nown database objects, this is a finding.\n    Check for the following:\n\n    Execute the command\n     #GET /db/_security\n    #grep names and verify that all users are authorized to own\ndatabase objects.\n  \"\n  desc  \"fix\", \"\n    Assign ownership of authorized objects to authorized object owner accounts.\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000133-DB-000200\"\n  tag \"gid\": \"V-32412\"\n  tag \"rid\": \"SV-42749r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000133-DB-000200\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001499\"]\n  tag \"nist\": [\"CM-5 (6)\", \"Rev_4\"]\n\n  admin_roles = input('approved_admin')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  admin_roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/_node/_local/_config/admins') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32412.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"couchdba\"","run_time":0.0661238,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"admin\"","run_time":0.0564381,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32415","title":"The DBMS must limit privileges to change software modules, to include\nstored procedures, functions and triggers, and links to software external to\nthe DBMS.","desc":"If the system were to allow any user to make changes to software\nlibraries, then those changes might be implemented without undergoing the\nappropriate testing and approvals that are part of a robust change management\nprocess.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.","descriptions":[{"label":"default","data":"If the system were to allow any user to make changes to software\nlibraries, then those changes might be implemented without undergoing the\nappropriate testing and approvals that are part of a robust change management\nprocess.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations."},{"label":"check","data":"Review monitoring procedures and implementation evidence to verify\nmonitoring of changes to database software libraries, related applications, and\nconfiguration files is done.\n\n    Verify the list of files, directories, and database application objects\n(procedures, functions, and triggers) being monitored is complete.\n\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding.\n    If monitoring does not occur or is not complete, this is a finding."},{"label":"fix","data":"Implement procedures to monitor for unauthorized changes to DBMS software\nlibraries, related software application libraries, and configuration files. If\na third-party automated tool is not employed, an automated job that reports\nfile information on the directories and files of interest and compares them to\nthe baseline report for the same will meet the requirement.\n\n    Use file hashes or checksums for comparisons, as file dates may be\nmanipulated by malicious users.\n\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\"admins\":{\"names\":[\"superuser\"],\"roles\":[\"admins\"]},\"members\":{\"names\":\n[\"user1\",\"user2\"],\"roles\": [\"developers\"]}}'"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000133-DB-000179","gid":"V-32415","rid":"SV-42752r3_rule","stig_id":"SRG-APP-000133-DB-000179","fix_id":null,"cci":["CCI-001499"],"nist":["CM-5 (6)","Rev_4"]},"code":"control \"V-32415\" do\n  title \"The DBMS must limit privileges to change software modules, to include\nstored procedures, functions and triggers, and links to software external to\nthe DBMS.\"\n  desc  \"If the system were to allow any user to make changes to software\nlibraries, then those changes might be implemented without undergoing the\nappropriate testing and approvals that are part of a robust change management\nprocess.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.\n  \"\n  desc  \"check\", \"\n     Review monitoring procedures and implementation evidence to verify\nmonitoring of changes to database software libraries, related applications, and\nconfiguration files is done.\n\n    Verify the list of files, directories, and database application objects\n(procedures, functions, and triggers) being monitored is complete.\n\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding.\n    If monitoring does not occur or is not complete, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Implement procedures to monitor for unauthorized changes to DBMS software\nlibraries, related software application libraries, and configuration files. If\na third-party automated tool is not employed, an automated job that reports\nfile information on the directories and files of interest and compares them to\nthe baseline report for the same will meet the requirement.\n\n    Use file hashes or checksums for comparisons, as file dates may be\nmanipulated by malicious users.\n\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\\\"admins\\\":{\\\"names\\\":[\\\"superuser\\\"],\\\"roles\\\":[\\\"admins\\\"]},\\\"members\\\":{\\\"names\\\":\n[\\\"user1\\\",\\\"user2\\\"],\\\"roles\\\": [\\\"developers\\\"]}}'\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000133-DB-000179\"\n  tag \"gid\": \"V-32415\"\n  tag \"rid\": \"SV-42752r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000133-DB-000179\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001499\"]\n  tag \"nist\": [\"CM-5 (6)\", \"Rev_4\"]\n\n  roles = input('approved_users')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/' + database + '/_security') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32415.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couchdba\"","run_time":0.0659292,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"admin\"","run_time":0.0560189,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couch_user\"","run_time":0.054239,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32426","title":"Unused database components that are integrated in the DBMS and cannot\nbe uninstalled must be disabled.","desc":"Information systems are capable of providing a wide variety of\nfunctions and services. Some of the functions and services, provided by\ndefault, may not be necessary to support essential organizational operations\n(e.g., key missions, functions).\n\n    It is detrimental for software products to provide, or install by default,\nfunctionality exceeding requirements or mission objectives.\n\n    DBMSs must adhere to the principles of least functionality by providing\nonly essential capabilities.\n\n    Unused, unnecessary DBMS components increase the attack vector for the DBMS\nby introducing additional targets for attack. By minimizing the services and\napplications installed on the system, the number of potential vulnerabilities\nis reduced. Components of the system that are unused and cannot be uninstalled\nmust be disabled. The techniques available for disabling components will vary\nby DBMS product, OS, and the nature of the component and may include DBMS\nconfiguration settings, OS service settings, OS file access security, and DBMS\nuser/role permissions.","descriptions":[{"label":"default","data":"Information systems are capable of providing a wide variety of\nfunctions and services. Some of the functions and services, provided by\ndefault, may not be necessary to support essential organizational operations\n(e.g., key missions, functions).\n\n    It is detrimental for software products to provide, or install by default,\nfunctionality exceeding requirements or mission objectives.\n\n    DBMSs must adhere to the principles of least functionality by providing\nonly essential capabilities.\n\n    Unused, unnecessary DBMS components increase the attack vector for the DBMS\nby introducing additional targets for attack. By minimizing the services and\napplications installed on the system, the number of potential vulnerabilities\nis reduced. Components of the system that are unused and cannot be uninstalled\nmust be disabled. The techniques available for disabling components will vary\nby DBMS product, OS, and the nature of the component and may include DBMS\nconfiguration settings, OS service settings, OS file access security, and DBMS\nuser/role permissions."},{"label":"check","data":"To list all installed packages, as the system administrator, run the\nfollowing:\n\n    # RHEL/CENT Systems\n    $ sudo yum list installed | grep couchdb\n\n    # Debian Systems\n    $ dpkg --get-selections | grep couchdb\n\n    If any packages are installed that are not required, this is a finding."},{"label":"fix","data":"To remove any unneeded executables, as the system administrator, run the\nfollowing:\n\n    # RHEL/CENT Systems\n    $ sudo yum erase <package_name>\n\n    # Debian Systems\n    $ sudo apt-get remove <package_name>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000141-DB-000092","gid":"V-32426","rid":"SV-42763r4_rule","stig_id":"SRG-APP-000141-DB-000092","fix_id":null,"cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"]},"code":"control \"V-32426\" do\n  title \"Unused database components that are integrated in the DBMS and cannot\nbe uninstalled must be disabled.\"\n  desc  \"Information systems are capable of providing a wide variety of\nfunctions and services. Some of the functions and services, provided by\ndefault, may not be necessary to support essential organizational operations\n(e.g., key missions, functions).\n\n    It is detrimental for software products to provide, or install by default,\nfunctionality exceeding requirements or mission objectives.\n\n    DBMSs must adhere to the principles of least functionality by providing\nonly essential capabilities.\n\n    Unused, unnecessary DBMS components increase the attack vector for the DBMS\nby introducing additional targets for attack. By minimizing the services and\napplications installed on the system, the number of potential vulnerabilities\nis reduced. Components of the system that are unused and cannot be uninstalled\nmust be disabled. The techniques available for disabling components will vary\nby DBMS product, OS, and the nature of the component and may include DBMS\nconfiguration settings, OS service settings, OS file access security, and DBMS\nuser/role permissions.\n  \"\n  desc  \"check\", \"\n     To list all installed packages, as the system administrator, run the\nfollowing:\n\n    # RHEL/CENT Systems\n    $ sudo yum list installed | grep couchdb\n\n    # Debian Systems\n    $ dpkg --get-selections | grep couchdb\n\n    If any packages are installed that are not required, this is a finding.\n  \"\n  desc  \"fix\", \"\n    To remove any unneeded executables, as the system administrator, run the\nfollowing:\n\n    # RHEL/CENT Systems\n    $ sudo yum erase <package_name>\n\n    # Debian Systems\n    $ sudo apt-get remove <package_name>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000141-DB-000092\"\n  tag \"gid\": \"V-32426\"\n  tag \"rid\": \"SV-42763r4_rule\"\n  tag \"stig_id\": \"SRG-APP-000141-DB-000092\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000381\"]\n  tag \"nist\": [\"CM-7 a\", \"Rev_4\"]\n\n  if os.debian?\n    dpkg_packages = command(\"dpkg --get-selections | grep \\\"couchdb\\\"\").stdout.tr('install','').split(\"\\n\")\n    dpkg_packages.each do |packages|\n      describe(packages) do\n        it { should be_in approved_packages }\n      end\n    end\n  \n  elsif os.linux? || os.redhat?\n    yum_packages = command(\"yum list installed | grep \\\"couchdb\\\"\").stdout.strip.tr(' ','').split(\"\\n\")\n    yum_packages.each do |packages|\n      describe(packages) do\n        it { should be_in approved_packages }\n      end\n    end\n  end\nend\n","source_location":{"line":15,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32426.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"couch-js.x86_641:1.8.5-21.el7@bintray--apache-couchdb-rpm is expected to be in \"\"","run_time":0.0565291,"start_time":"2020-08-07T14:43:19-04:00","message":"expected `couch-js.x86_641:1.8.5-21.el7@bintray--apache-couchdb-rpm` to be in the list: `[\"\"]`"},{"status":"failed","code_desc":"couchdb.x86_643.1.0-1.el7@bintray--apache-couchdb-rpm is expected to be in \"\"","run_time":0.0001686,"start_time":"2020-08-07T14:43:19-04:00","message":"expected `couchdb.x86_643.1.0-1.el7@bintray--apache-couchdb-rpm` to be in the list: `[\"\"]`"}]},{"id":"V-32468","title":"If passwords are used for authentication, the DBMS must store only\nhashed, salted representations of passwords.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, database passwords stored in clear text, using reversible\nencryption, or using unsalted hashes would be vulnerable to unauthorized\ndisclosure. Database passwords must always be in the form of one-way, salted\nhashes when stored internally or externally to the DBMS.","descriptions":[{"label":"default","data":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, database passwords stored in clear text, using reversible\nencryption, or using unsalted hashes would be vulnerable to unauthorized\ndisclosure. Database passwords must always be in the form of one-way, salted\nhashes when stored internally or externally to the DBMS."},{"label":"check","data":"Review the CouchDB database settings relating to passwords that are used\nfor authentication, the CouchDB database must store only hashed, salted\nrepresentations of passwords.\n\n    CouchDB salts and hashes passwords automatically, but can be verified by:\n    # find . -name \"local.ini\"\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n    The -pbkdf2- at the begining indicates that it is hashed. If this pre-fix\nis not there, this is a finding."},{"label":"fix","data":"Restart the CouchDB services.\n    # sudo restart couchdb\n    CouchDB documentation outlines that during startup it is verified that\npasswords are hashed and if it is not, then it is done then."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000171-DB-000074","gid":"V-32468","rid":"SV-42805r3_rule","stig_id":"SRG-APP-000171-DB-000074","fix_id":"F-36383r4_fix","cci":["CCI-000196"],"nist":["IA-5 (1) (c)","Rev_4"]},"code":"control \"V-32468\" do\n  title \"If passwords are used for authentication, the DBMS must store only\nhashed, salted representations of passwords.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, database passwords stored in clear text, using reversible\nencryption, or using unsalted hashes would be vulnerable to unauthorized\ndisclosure. Database passwords must always be in the form of one-way, salted\nhashes when stored internally or externally to the DBMS.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database settings relating to passwords that are used\nfor authentication, the CouchDB database must store only hashed, salted\nrepresentations of passwords.\n\n    CouchDB salts and hashes passwords automatically, but can be verified by:\n    # find . -name \\\"local.ini\\\"\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n    The -pbkdf2- at the begining indicates that it is hashed. If this pre-fix\nis not there, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Restart the CouchDB services.\n    # sudo restart couchdb\n    CouchDB documentation outlines that during startup it is verified that\npasswords are hashed and if it is not, then it is done then.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000171-DB-000074\"\n  tag \"gid\": \"V-32468\"\n  tag \"rid\": \"SV-42805r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000171-DB-000074\"\n  tag \"fix_id\": \"F-36383r4_fix\"\n  tag \"cci\": [\"CCI-000196\"]\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n  describe file(input('couchdb_conf_local')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_local')) do\n    its('admins.admin') { should match '-pbkdf2-' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32468.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/local.ini is expected to exist","run_time":0.0515933,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini admins.admin is expected to match \"-pbkdf2-\"","run_time":0.007612,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32469","title":"If passwords are used for authentication, the DBMS must transmit only\nencrypted representations of passwords.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database.","descriptions":[{"label":"default","data":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database."},{"label":"check","data":"Review the CouchDB database settings relating to passwords are used for\nauthentication, CouchDB must transmit only encrypted representations of\npasswords.\n\n    CouchDB salts and hashes passwords automatically, but can be verified by:\n    # find . -name \"local.ini\"\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n    The -pbkdf2- at the begining indicates that it is hashed. If this pre-fix\nis not there, this is a finding."},{"label":"fix","data":"Restart the CouchDB services.\n    # sudo restart couchdb\n    CouchDB documentation outlines that during startup it is verified that\npasswords are hashed and if it is not, then it is done then."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000172-DB-000075","gid":"V-32469","rid":"SV-42806r3_rule","stig_id":"SRG-APP-000172-DB-000075","fix_id":null,"cci":["CCI-000197"],"nist":["IA-5 (1) (c)","Rev_4"]},"code":"control \"V-32469\" do\n  title \"If passwords are used for authentication, the DBMS must transmit only\nencrypted representations of passwords.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database settings relating to passwords are used for\nauthentication, CouchDB must transmit only encrypted representations of\npasswords.\n\n    CouchDB salts and hashes passwords automatically, but can be verified by:\n    # find . -name \\\"local.ini\\\"\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n    The -pbkdf2- at the begining indicates that it is hashed. If this pre-fix\nis not there, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Restart the CouchDB services.\n    # sudo restart couchdb\n    CouchDB documentation outlines that during startup it is verified that\npasswords are hashed and if it is not, then it is done then.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000172-DB-000075\"\n  tag \"gid\": \"V-32469\"\n  tag \"rid\": \"SV-42806r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000172-DB-000075\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000197\"]\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_local')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_local')) do\n    its('admins.admin') { should match '-pbkdf2-' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32469.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/local.ini is expected to exist","run_time":0.0444832,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini admins.admin is expected to match \"-pbkdf2-\"","run_time":0.0001448,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32475","title":"The DBMS, when utilizing PKI-based authentication, must validate\ncertificates by performing RFC 5280-compliant certification path validation.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate’s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database.","descriptions":[{"label":"default","data":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate’s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database."},{"label":"check","data":"# find local.ini\n    # grep \"cacert_file =\" <path to local.ini>\n    If cacert_file path does not exist, this is a finding.\n    # grep \"cert_file =\" <path to local.ini>\n    If cert_file path does not exist, this is a finding.\n    # grep \"secure_renegotiate\" <path to local.ini>\n    If commented out, or not set to true, this is a finding.\n\n    If certificates are not being validated by performing RFC 5280-compliant\ncertification path validation, this is a finding."},{"label":"fix","data":"# find local.ini\n    # set secure_renegotiate = true\n    # set cacert_file = <cert path>\n    # set cert_file = <cert path>\n\n    Verify certificates are being validated by performing RFC 5280-compliant\ncertification path validation."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000175-DB-000067","gid":"V-32475","rid":"SV-42812r3_rule","stig_id":"SRG-APP-000175-DB-000067","fix_id":"F-36390r3_fix","cci":["CCI-000185"],"nist":["IA-5 (2) (a)","Rev_4"]},"code":"control \"V-32475\" do\n  title \"The DBMS, when utilizing PKI-based authentication, must validate\ncertificates by performing RFC 5280-compliant certification path validation.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate\\xE2\\x80\\x99s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database.\n  \"\n  desc  \"check\", \"\n    # find local.ini\n    # grep \\\"cacert_file =\\\" <path to local.ini>\n    If cacert_file path does not exist, this is a finding.\n    # grep \\\"cert_file =\\\" <path to local.ini>\n    If cert_file path does not exist, this is a finding.\n    # grep \\\"secure_renegotiate\\\" <path to local.ini>\n    If commented out, or not set to true, this is a finding.\n\n    If certificates are not being validated by performing RFC 5280-compliant\ncertification path validation, this is a finding.\n  \"\n  desc  \"fix\", \"\n    # find local.ini\n    # set secure_renegotiate = true\n    # set cacert_file = <cert path>\n    # set cert_file = <cert path>\n\n    Verify certificates are being validated by performing RFC 5280-compliant\ncertification path validation.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000175-DB-000067\"\n  tag \"gid\": \"V-32475\"\n  tag \"rid\": \"SV-42812r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000175-DB-000067\"\n  tag \"fix_id\": \"F-36390r3_fix\"\n  tag \"cci\": [\"CCI-000185\"]\n  tag \"nist\": [\"IA-5 (2) (a)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.secure_renegotiate') { should eq 'true' }\n    its('ssl.cert_file') {should eq '/etc/couchdb/cert/couchdb.pem'}\n    its('ssl.key_file') {should eq '/etc/couchdb/cert/privkey.pem'}\n    its('ssl.cacert_file') {should eq '/etc/ssl/certs/ca-certificates.crt'}\n  end\n\n  describe file(input('couchdbpem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end\n\n  describe file(input('privkeypem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end \nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32475.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.secure_renegotiate is expected to eq \"true\"","run_time":0.0073324,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cert_file is expected to eq \"/etc/couchdb/cert/couchdb.pem\"","run_time":0.0001013,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.key_file is expected to eq \"/etc/couchdb/cert/privkey.pem\"","run_time":7.28e-05,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cacert_file is expected to eq \"/etc/ssl/certs/ca-certificates.crt\"","run_time":9.47e-05,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem is expected to exist","run_time":0.0449271,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem mode is expected to equal 384","run_time":0.0634356,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem is expected to exist","run_time":0.04454,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem mode is expected to equal 384","run_time":0.0451513,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32476","title":"The DBMS must enforce authorized access to all PKI private keys\nstored/utilized by the DBMS.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the systems clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions.","descriptions":[{"label":"default","data":"The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the systems clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions."},{"label":"check","data":"Review CouchDB configuration to determine whether appropriate access\ncontrols exist to protect CouchDB's private key(s). If the CouchDBs private\nkey(s) are not stored in a FIPS 140-2 validated cryptographic module, this is a\nfinding.\n\n    # find . -name \"local.ini\"\n\n    # grep ssl section\n    # grep \"cacert_file =\" <path to local.ini>\n    # grep \"cert_file =\" <path to local.ini>\n    # grep \"key_file =\" <path to local.ini>\n\n    If the directory these files are stored in is not protected, this is a\nfinding."},{"label":"fix","data":"Store all CouchDB PKI private keys in a FIPS 140-2-validated cryptographic\nmodule.\n\n    Ensure access to Couch PKI private keys is restricted to only authenticated\nand authorized users.\n\n    Example:\n\n    ssl_ca_file = \"/some/protected/directory/root.crt\"\n    ssl_crl_file = \"/some/protected/directory/root.crl\"\n    ssl_cert_file = \"/some/protected/directory/server.crt\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000176-DB-000068","gid":"V-32476","rid":"SV-42813r3_rule","stig_id":"SRG-APP-000176-DB-000068","fix_id":null,"cci":["CCI-000186"],"nist":["IA-5 (2)","Rev_4"]},"code":"control \"V-32476\" do\n  title \"The DBMS must enforce authorized access to all PKI private keys\nstored/utilized by the DBMS.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the systems clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions.\n  \"\n  desc  \"check\", \"\n    Review CouchDB configuration to determine whether appropriate access\ncontrols exist to protect CouchDB's private key(s). If the CouchDBs private\nkey(s) are not stored in a FIPS 140-2 validated cryptographic module, this is a\nfinding.\n\n    # find . -name \\\"local.ini\\\"\n\n    # grep ssl section\n    # grep \\\"cacert_file =\\\" <path to local.ini>\n    # grep \\\"cert_file =\\\" <path to local.ini>\n    # grep \\\"key_file =\\\" <path to local.ini>\n\n    If the directory these files are stored in is not protected, this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Store all CouchDB PKI private keys in a FIPS 140-2-validated cryptographic\nmodule.\n\n    Ensure access to Couch PKI private keys is restricted to only authenticated\nand authorized users.\n\n    Example:\n\n    ssl_ca_file = \\\"/some/protected/directory/root.crt\\\"\n    ssl_crl_file = \\\"/some/protected/directory/root.crl\\\"\n    ssl_cert_file = \\\"/some/protected/directory/server.crt\\\"\n\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000176-DB-000068\"\n  tag \"gid\": \"V-32476\"\n  tag \"rid\": \"SV-42813r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000176-DB-000068\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000186\"]\n  tag \"nist\": [\"IA-5 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.secure_renegotiate') { should eq 'true' }\n    its('ssl.cert_file') {should eq '/etc/couchdb/cert/couchdb.pem'}\n    its('ssl.cacert_file') {should eq '/etc/ssl/certs/ca-certificates.crt'}\n    its('ssl.key_file') {should eq '/etc/couchdb/cert/privkey.pem'}\n  end\n  \n  describe file(input('couchdbpem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end\n\n  describe file(input('privkeypem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end \nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32476.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.secure_renegotiate is expected to eq \"true\"","run_time":0.0002242,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cert_file is expected to eq \"/etc/couchdb/cert/couchdb.pem\"","run_time":0.0001395,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cacert_file is expected to eq \"/etc/ssl/certs/ca-certificates.crt\"","run_time":9.91e-05,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.key_file is expected to eq \"/etc/couchdb/cert/privkey.pem\"","run_time":7.08e-05,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem is expected to exist","run_time":0.0546199,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem mode is expected to equal 384","run_time":0.0455007,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem is expected to exist","run_time":0.0547177,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem mode is expected to equal 384","run_time":0.0551612,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32480","title":"The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.","desc":"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.","descriptions":[{"label":"default","data":"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules."},{"label":"check","data":"As the system administrator, run the following:\n\n$ openssl version\n\nIf \"fips\" is not included in the openssl version, this is a finding."},{"label":"fix","data":"Configure OpenSSL to meet FIPS Compliance using the following documentation\nin section 9.1:\n\n    http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1758.pdf"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000179-DB-000114","gid":"V-32480","rid":"SV-42817r3_rule","stig_id":"SRG-APP-000179-DB-000114","fix_id":null,"cci":["CCI-000803"],"nist":["IA-7","Rev_4"]},"code":"control \"V-32480\" do\n  title \"The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.\"\n  desc  \"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.\n  \"\n  desc  \"check\", \"\n    As the system administrator, run the following:\n\n    $ openssl version\n\n    If \\\"fips\\\" is not included in the openssl version, this is a finding.\n\n  \"\n  desc  \"fix\", \"\n    Configure OpenSSL to meet FIPS Compliance using the following documentation\nin section 9.1:\n\n    http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1758.pdf\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000179-DB-000114\"\n  tag \"gid\": \"V-32480\"\n  tag \"rid\": \"SV-42817r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000179-DB-000114\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000803\"]\n  tag \"nist\": [\"IA-7\", \"Rev_4\"]\n\n  describe command('openssl version') do\n    its('stdout') { should match 'fips' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32480.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `openssl version` stdout is expected to match \"fips\"","run_time":0.0546218,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32523","title":"The DBMS must invalidate session identifiers upon user logout or other\nsession termination.","desc":"Captured sessions can be reused in \"replay\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked.","descriptions":[{"label":"default","data":"Captured sessions can be reused in \"replay\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked."},{"label":"check","data":"Review DBMS settings and vendor documentation to verify user sessions are\nterminated, and session identifiers invalidated, upon user logout. If they are\nnot, this is a finding.\n\n    Review system documentation and organization policy to identify other\nevents that should result in session terminations.\n    # find . -name \"default.ini\"\n    #grep couch_httpd_auth\n    Verify the timeout variable has a set time\n    Ex:  timeout = 600\n    #grep \"couchdb\" section\n    #Verify \"os_process_timeout\" has a set time\n\n    If other session termination events are defined, review DBMS settings to\nverify occurrences of these events would cause session termination,\ninvalidating the session identifiers.\n\n    If occurrences of defined session terminating events do not cause session\nterminations, invalidating the session identifiers, this is a finding."},{"label":"fix","data":"Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon user logout.\n\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon the occurrence of any organization- or policy-defined session\ntermination event.\n    # Set timeout variable to be 600\n    # Set os_process_timeout to be 5000"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000220-DB-000149","gid":"V-32523","rid":"SV-42860r2_rule","stig_id":"SRG-APP-000220-DB-000149","fix_id":null,"cci":["CCI-001185"],"nist":["SC-23 (1)","Rev_4"]},"code":"control \"V-32523\" do\n  title \"The DBMS must invalidate session identifiers upon user logout or other\nsession termination.\"\n  desc  \"Captured sessions can be reused in \\\"replay\\\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked.\n  \"\n  desc  \"check\", \"\n    Review DBMS settings and vendor documentation to verify user sessions are\nterminated, and session identifiers invalidated, upon user logout. If they are\nnot, this is a finding.\n\n    Review system documentation and organization policy to identify other\nevents that should result in session terminations.\n    # find . -name \\\"default.ini\\\"\n    #grep couch_httpd_auth\n    Verify the timeout variable has a set time\n    Ex:  timeout = 600\n    #grep \\\"couchdb\\\" section\n    #Verify \\\"os_process_timeout\\\" has a set time\n\n    If other session termination events are defined, review DBMS settings to\nverify occurrences of these events would cause session termination,\ninvalidating the session identifiers.\n\n    If occurrences of defined session terminating events do not cause session\nterminations, invalidating the session identifiers, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon user logout.\n\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon the occurrence of any organization- or policy-defined session\ntermination event.\n    # Set timeout variable to be 600\n    # Set os_process_timeout to be 5000\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000220-DB-000149\"\n  tag \"gid\": \"V-32523\"\n  tag \"rid\": \"SV-42860r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000220-DB-000149\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001185\"]\n  tag \"nist\": [\"SC-23 (1)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('couchdb_httpd_auth.timeout') { cmp >= 600 }\n    its('couchdb.os_process_timeout') { should_not be nil }\n\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32523.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couchdb_httpd_auth.timeout ","run_time":0.0002654,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couchdb.os_process_timeout is expected not to equal nil","run_time":0.0002098,"start_time":"2020-08-07T14:43:19-04:00"}]},{"id":"V-32536","title":"The DBMS must isolate security functions from non-security functions.","desc":"An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality.","descriptions":[{"label":"default","data":"An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality."},{"label":"check","data":"Check DBMS settings to determine whether objects or code implementing\nsecurity functionality are located in a separate security domain, such as a\nseparate database or schema created specifically for security functionality.\n\n\n    Execute the command\n     #GET /db/_security\n    #grep names and verify that all users that are listed in access privileges\nand are documented.\n    If any user besides the database administrator(s) is listed in access\nprivileges and not documented, this is a finding.\n\n    If security-related database objects or code are not kept separate, this is\na finding."},{"label":"fix","data":"Locate security-related database objects and code in a\nseparate database, schema, or other separate security domain from database\nobjects and code implementing application logic."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000233-DB-000124","gid":"V-32536","rid":"SV-42873r3_rule","stig_id":"SRG-APP-000233-DB-000124","fix_id":null,"cci":["CCI-001084"],"nist":["SC-3","Rev_4"]},"code":"control \"V-32536\" do\n  title 'The DBMS must isolate security functions from non-security functions.'\n  desc  \"An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality.\n  \"\n  desc  \"check\", \"\n    Check DBMS settings to determine whether objects or code implementing\nsecurity functionality are located in a separate security domain, such as a\nseparate database or schema created specifically for security functionality.\n\n\n    Execute the command\n     #GET /db/_security\n    #grep names and verify that all users that are listed in access privileges\nand are documented.\n    If any user besides the database administrator(s) is listed in access\nprivileges and not documented, this is a finding.\n\n    If security-related database objects or code are not kept separate, this is\na finding.\n  \"\n  desc  \"fix\", \" Locate security-related database objects and code in a\nseparate database, schema, or other separate security domain from database\nobjects and code implementing application logic.\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000233-DB-000124\"\n  tag \"gid\": \"V-32536\"\n  tag \"rid\": \"SV-42873r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000233-DB-000124\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001084\"]\n  tag \"nist\": [\"SC-3\", \"Rev_4\"]\n\n  admin_roles = input('approved_admin')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  admin_roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/_node/_local/_config/admins') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32536.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"couchdba\"","run_time":0.0544578,"start_time":"2020-08-07T14:43:19-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"admin\"","run_time":0.0550256,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58049","title":"The DBMS must utilize centralized management of the content captured\nin audit records generated by all components of the DBMS.","desc":"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.","descriptions":[{"label":"default","data":"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system."},{"label":"check","data":"Review the system documentation for a description of how audit records are\noff-loaded and how local audit log space is managed.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep log section\n    #grep \"sys_facilities =\" <path to default.ini>\n    If the CouchDB audit records are not written directly to or systematically\ntransferred to a centralized log management system, this is a finding."},{"label":"fix","data":"Configure and/or deploy software tools to ensure that the\nCouchDB audit records are written directly to or systematically transferred to\na centralized log management system. Configure loging to be enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000356-DB-000314","gid":"V-58049","rid":"SV-72479r1_rule","stig_id":"SRG-APP-000356-DB-000314","fix_id":null,"cci":["CCI-001844"],"nist":["AU-3 (2)","Rev_4"]},"code":"control \"V-58049\" do\n  title \"The DBMS must utilize centralized management of the content captured\nin audit records generated by all components of the DBMS.\"\n  desc  \"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.\n  \"\n  desc  \"check\", \"\n    Review the system documentation for a description of how audit records are\noff-loaded and how local audit log space is managed.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep log section\n    #grep \\\"sys_facilities =\\\" <path to default.ini>\n    If the CouchDB audit records are not written directly to or systematically\ntransferred to a centralized log management system, this is a finding.\n  \"\n  desc  \"fix\", \"Configure and/or deploy software tools to ensure that the\nCouchDB audit records are written directly to or systematically transferred to\na centralized log management system. Configure loging to be enabled\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000356-DB-000314\"\n  tag \"gid\": \"V-58049\"\n  tag \"rid\": \"SV-72479r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000356-DB-000314\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001844\"]\n  tag \"nist\": [\"AU-3 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.syslog_facility') { should cmp /local[0-7]/i }\n    end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58049.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.syslog_facility is expected to cmp == /local[0-7]/i","run_time":0.0002991,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58051","title":"The DBMS must provide centralized configuration of the content to be\ncaptured in audit records generated by all components of the DBMS.","desc":"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration.","descriptions":[{"label":"default","data":"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for centralized\nconfiguration of the content to be captured in audit records generated by all\ncomponents of the CouchDB database.\n\n    # find . -name \"default.ini\"\n\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log audit records for centralized configuration of the\ncontent to be captured in audit records generated by all components of the\nCouchDB database, this is a finding."},{"label":"fix","data":"Configure CouchDB to provide centralized configuration of the content to be\ncaptured in audit records generated by all components of CouchDB.\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000356-DB-000315","gid":"V-58051","rid":"SV-72481r1_rule","stig_id":"SRG-APP-000356-DB-000315","fix_id":null,"cci":["CCI-001844"],"nist":["AU-3 (2)","Rev_4"]},"code":"control \"V-58051\" do\n  title \"The DBMS must provide centralized configuration of the content to be\ncaptured in audit records generated by all components of the DBMS.\"\n  desc  \"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for centralized\nconfiguration of the content to be captured in audit records generated by all\ncomponents of the CouchDB database.\n\n    # find . -name \\\"default.ini\\\"\n\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log audit records for centralized configuration of the\ncontent to be captured in audit records generated by all components of the\nCouchDB database, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to provide centralized configuration of the content to be\ncaptured in audit records generated by all components of CouchDB.\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000356-DB-000315\"\n  tag \"gid\": \"V-58051\"\n  tag \"rid\": \"SV-72481r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000356-DB-000315\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001844\"]\n  tag \"nist\": [\"AU-3 (2)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58051.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0546439,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0002541,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58055","title":"The DBMS must off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.","desc":"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.","descriptions":[{"label":"default","data":"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system."},{"label":"check","data":"Review the system documentation for a description of how audit records are\noff-loaded.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep 'syslog_facility'\n    Check with the organization to see how syslog facilities are defined in\ntheir organization.\n\n    If the wrong facility is configured, this is a finding.\n\n    If CouchDB has a continuous network connection to the centralized log\nmanagement system, but CouchDB audit records are not written directly to the\ncentralized log management system or transferred in near-real-time, this is a\nfinding.\n\n    If CouchDB does not have a continuous network connection to the centralized\nlog management system, and CouchDB audit records are not transferred to the\ncentralized log management system weekly or more often, this is a finding."},{"label":"fix","data":"Configure CouchDB to off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\n\n    Ensure logging is enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000515-DB-000318","gid":"V-58055","rid":"SV-72485r1_rule","stig_id":"SRG-APP-000515-DB-000318","fix_id":null,"cci":["CCI-001851"],"nist":["AU-4 (1)","Rev_4"]},"code":"control \"V-58055\" do\n  title \"The DBMS must off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\"\n  desc  \"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.\n  \"\n  desc  \"check\", \"\n    Review the system documentation for a description of how audit records are\noff-loaded.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep 'syslog_facility'\n    Check with the organization to see how syslog facilities are defined in\ntheir organization.\n\n    If the wrong facility is configured, this is a finding.\n\n    If CouchDB has a continuous network connection to the centralized log\nmanagement system, but CouchDB audit records are not written directly to the\ncentralized log management system or transferred in near-real-time, this is a\nfinding.\n\n    If CouchDB does not have a continuous network connection to the centralized\nlog management system, and CouchDB audit records are not transferred to the\ncentralized log management system weekly or more often, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\n\n    Ensure logging is enabled\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000515-DB-000318\"\n  tag \"gid\": \"V-58055\"\n  tag \"rid\": \"SV-72485r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000515-DB-000318\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001851\"]\n  tag \"nist\": [\"AU-4 (1)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n  its('log.syslog_facility') { should cmp /local[0-7]/i }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58055.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.syslog_facility is expected to cmp == /local[0-7]/i","run_time":0.0002707,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58059","title":"The DBMS must provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures. ","desc":"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less).","descriptions":[{"label":"default","data":"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less)."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide an immediate real-time alert\nto appropriate support staff of all audit log failures.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #grep \"write_delay = \" <path to default.ini>\n    if line does not exist or is not set to 0, this is a finding.\n\n    If it is not set to provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures, this is a finding."},{"label":"fix","data":"Configure CouchDB log records to record an immediate real-time alert to\nappropriate support staff of all audit log failures.\n\n    # find . -name \"default.ini\"\n    # set write_delay = 0"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000360-DB-000320","gid":"V-58059","rid":"SV-72489r2_rule","stig_id":"SRG-APP-000360-DB-000320","fix_id":null,"cci":["CCI-001858"],"nist":["AU-5 (2)","Rev_4"]},"code":"control \"V-58059\" do\n  title \"The DBMS must provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures. \"\n  desc  \"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less).\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide an immediate real-time alert\nto appropriate support staff of all audit log failures.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #grep \\\"write_delay = \\\" <path to default.ini>\n    if line does not exist or is not set to 0, this is a finding.\n\n    If it is not set to provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB log records to record an immediate real-time alert to\nappropriate support staff of all audit log failures.\n\n    # find . -name \\\"default.ini\\\"\n    # set write_delay = 0\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000360-DB-000320\"\n  tag \"gid\": \"V-58059\"\n  tag \"rid\": \"SV-72489r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000360-DB-000320\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001858\"]\n  tag \"nist\": [\"AU-5 (2)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.write_delay') { should eq '0'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58059.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0456901,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.write_delay is expected to eq \"0\"","run_time":0.0002269,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58063","title":"The DBMS must record time stamps, in audit records and application\ndata, that can be mapped to Coordinated Universal Time (UTC, formerly GMT).","desc":"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.","descriptions":[{"label":"default","data":"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide record time stamps, in audit\nrecords and application data, that can be mapped to Coordinated Universal Time\n(UTC, formerly GMT).\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"writer = \" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to provide record time stamps, in audit records and\napplication data, that can be mapped to Coordinated Universal Time (UTC,\nformerly GMT), this is a finding."},{"label":"fix","data":"If applicable remove or comment out the line writer = journald\nwriter needs to be set equal to file\n\nFile variable needs to be set to path to where log file will be stored.\n# find . -name \"default.ini\"\n#writer = <path to log file>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000374-DB-000322","gid":"V-58063","rid":"SV-72493r1_rule","stig_id":"SRG-APP-000374-DB-000322","fix_id":null,"cci":["CCI-001890"],"nist":["AU-8 b","Rev_4"]},"code":"control \"V-58063\" do\n  title \"The DBMS must record time stamps, in audit records and application\ndata, that can be mapped to Coordinated Universal Time (UTC, formerly GMT).\"\n  desc  \"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide record time stamps, in audit\nrecords and application data, that can be mapped to Coordinated Universal Time\n(UTC, formerly GMT).\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"writer = \\\" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to provide record time stamps, in audit records and\napplication data, that can be mapped to Coordinated Universal Time (UTC,\nformerly GMT), this is a finding.\n  \"\n  desc  \"fix\", \"\n    If applicable remove or comment out the line writer = journald\n    writer needs to be set equal to file\n\n    File variable needs to be set to path to where log file will be stored.\n    # find . -name \\\"default.ini\\\"\n    #writer = <path to log file>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000374-DB-000322\"\n  tag \"gid\": \"V-58063\"\n  tag \"rid\": \"SV-72493r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000374-DB-000322\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001890\"]\n  tag \"nist\": [\"AU-8 b\", \"Rev_4\"]\n\n  \n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.writer') { should_not eq 'journald'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58063.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0546334,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.writer is expected not to eq \"journald\"","run_time":0.0002355,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58065","title":"The DBMS must generate time stamps, for audit records and application\ndata, with a minimum granularity of one second.","desc":"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.","descriptions":[{"label":"default","data":"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to generate time stamps, for audit\nrecords and application data, with a minimum granularity of one second.\t\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"writer = \" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to generate time stamps, for audit records and application\ndata, with a minimum granularity of one second, this is a finding."},{"label":"fix","data":"If applicable remove or comment out the line writer = journald\nwriter needs to be set equal to file\nfile variable needs to be set to path to where log file will be stored.\n# set writer = <path to log file>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000375-DB-000323","gid":"V-58065","rid":"SV-72495r1_rule","stig_id":"SRG-APP-000375-DB-000323","fix_id":null,"cci":["CCI-001889"],"nist":["AU-8 b","Rev_4"]},"code":"control \"V-58065\" do\n  title \"The DBMS must generate time stamps, for audit records and application\ndata, with a minimum granularity of one second.\"\n  desc  \"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to generate time stamps, for audit\nrecords and application data, with a minimum granularity of one second.\\t\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"writer = \\\" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to generate time stamps, for audit records and application\ndata, with a minimum granularity of one second, this is a finding.\n  \"\n  desc  \"fix\", \"\n    If applicable remove or comment out the line writer = journald\n    writer needs to be set equal to file\n    file variable needs to be set to path to where log file will be stored.\n    # set writer = <path to log file>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000375-DB-000323\"\n  tag \"gid\": \"V-58065\"\n  tag \"rid\": \"SV-72495r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000375-DB-000323\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001889\"]\n  tag \"nist\": [\"AU-8 b\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.writer') { should_not eq 'journald'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58065.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0562286,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.writer is expected not to eq \"journald\"","run_time":0.0001676,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58123","title":"The DBMS must generate audit records for all direct access to the\ndatabase(s).","desc":"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources.","descriptions":[{"label":"default","data":"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for all direct\naccess to the database(s).\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log for all direct access to the database(s), this is a\nfinding."},{"label":"fix","data":"Configure CouchDB to enerate audit records for all direct access to the\ndatabase(s).\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000508-DB-000358","gid":"V-58123","rid":"SV-72553r1_rule","stig_id":"SRG-APP-000508-DB-000358","fix_id":null,"cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58123\" do\n  title \"The DBMS must generate audit records for all direct access to the\ndatabase(s).\"\n  desc  \"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources.\"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for all direct\naccess to the database(s).\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log for all direct access to the database(s), this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to enerate audit records for all direct access to the\ndatabase(s).\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000508-DB-000358\"\n  tag \"gid\": \"V-58123\"\n  tag \"rid\": \"SV-72553r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000508-DB-000358\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58123.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.04475,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0002081,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58125","title":"The DBMS must enforce access restrictions associated with changes to\nthe configuration of the DBMS or database(s).","desc":"Failure to provide logical access restrictions associated with changes\nto configuration may have significant effects on the overall security of the\nsystem.\n\n    When dealing with access restrictions pertaining to change control, it\nshould be noted that any changes to the hardware, software, and/or firmware\ncomponents of the information system can potentially have significant effects\non the overall security of the system.\n\n    Accordingly, only qualified and authorized individuals should be allowed to\nobtain access to system components for the purposes of initiating changes,\nincluding upgrades and modifications.","descriptions":[{"label":"default","data":"Failure to provide logical access restrictions associated with changes\nto configuration may have significant effects on the overall security of the\nsystem.\n\n    When dealing with access restrictions pertaining to change control, it\nshould be noted that any changes to the hardware, software, and/or firmware\ncomponents of the information system can potentially have significant effects\non the overall security of the system.\n\n    Accordingly, only qualified and authorized individuals should be allowed to\nobtain access to system components for the purposes of initiating changes,\nincluding upgrades and modifications."},{"label":"check","data":"To list the privileges, as the database administrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding."},{"label":"fix","data":"Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\"admins\":{\"names\":[\"superuser\"],\"roles\":[\"admins\"]},\"members\":{\"names\":\n[\"user1\",\"user2\"],\"roles\": [\"developers\"]}}'"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000380-DB-000360","gid":"V-58125","rid":"SV-72555r1_rule","stig_id":"SRG-APP-000380-DB-000360","fix_id":null,"cci":["CCI-001813"],"nist":["CM-5 (1)","Rev_4"]},"code":"control \"V-58125\" do\n  title \"The DBMS must enforce access restrictions associated with changes to\nthe configuration of the DBMS or database(s).\"\n  desc  \"Failure to provide logical access restrictions associated with changes\nto configuration may have significant effects on the overall security of the\nsystem.\n\n    When dealing with access restrictions pertaining to change control, it\nshould be noted that any changes to the hardware, software, and/or firmware\ncomponents of the information system can potentially have significant effects\non the overall security of the system.\n\n    Accordingly, only qualified and authorized individuals should be allowed to\nobtain access to system components for the purposes of initiating changes,\nincluding upgrades and modifications.\n  \"\n  desc  \"check\", \"\n    To list the privileges, as the database administrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\\\"admins\\\":{\\\"names\\\":[\\\"superuser\\\"],\\\"roles\\\":[\\\"admins\\\"]},\\\"members\\\":{\\\"names\\\":\n[\\\"user1\\\",\\\"user2\\\"],\\\"roles\\\": [\\\"developers\\\"]}}'\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000380-DB-000360\"\n  tag \"gid\": \"V-58125\"\n  tag \"rid\": \"SV-72555r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000380-DB-000360\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001813\"]\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_4\"]\n\n  admin_roles = input('approved_admin')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  admin_roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/_node/_local/_config/admins') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58125.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"couchdba\"","run_time":0.0666199,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/_node/_local/_config/admins` stdout is expected to include \"admin\"","run_time":0.055251,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58127","title":"The DBMS must produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the DBMS or\ndatabase(s).","desc":"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.","descriptions":[{"label":"default","data":"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact."},{"label":"check","data":"Review the CouchDB documentation to verify that audit records can produce\naudit records of its enforcement of access restrictions associated with changes\nto the configuration of database(s).\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the CouchDB\ndatabase, this is a finding."},{"label":"fix","data":"Configure CouchDB to verify that audit records can produce audit records\nof its enforcement of access restrictions associated with changes to the\nconfiguration of database(s).\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000381-DB-000361","gid":"V-58127","rid":"SV-72557r1_rule","stig_id":"SRG-APP-000381-DB-000361","fix_id":null,"cci":["CCI-001814"],"nist":["CM-5 (1)","Rev_4"]},"code":"control \"V-58127\" do\n  title \"The DBMS must produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the DBMS or\ndatabase(s).\"\n  desc  \"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB documentation to verify that audit records can produce\naudit records of its enforcement of access restrictions associated with changes\nto the configuration of database(s).\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the CouchDB\ndatabase, this is a finding.\n  \"\n  desc  \"fix\", \"\n     Configure CouchDB to verify that audit records can produce audit records\nof its enforcement of access restrictions associated with changes to the\nconfiguration of database(s).\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000381-DB-000361\"\n  tag \"gid\": \"V-58127\"\n  tag \"rid\": \"SV-72557r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000381-DB-000361\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001814\"]\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58127.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0559619,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0002001,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58129","title":"The role(s)/group(s) used to modify database structure (including but\nnot necessarily limited to tables, indexes, storage, etc.) and logic modules\n(stored procedures, functions, triggers, links to software external to the\nDBMS, etc.) must be restricted to authorized users.","desc":"If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.","descriptions":[{"label":"default","data":"If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations."},{"label":"check","data":"To list the privileges, as the database administrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding."},{"label":"fix","data":"Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\"admins\":{\"names\":[\"superuser\"],\"roles\":[\"admins\"]},\"members\":{\"names\":\n[\"user1\",\"user2\"],\"roles\": [\"developers\"]}}'"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000133-DB-000362","gid":"V-58129","rid":"SV-72559r1_rule","stig_id":"SRG-APP-000133-DB-000362","fix_id":null,"cci":["CCI-001499"],"nist":["CM-5 (6)","Rev_4"]},"code":"control \"V-58129\" do\n  title \"The role(s)/group(s) used to modify database structure (including but\nnot necessarily limited to tables, indexes, storage, etc.) and logic modules\n(stored procedures, functions, triggers, links to software external to the\nDBMS, etc.) must be restricted to authorized users.\"\n  desc  \"If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.\n  \"\n  desc  \"check\", \"\n\n\n    To list the privileges, as the database administrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\\\"admins\\\":{\\\"names\\\":[\\\"superuser\\\"],\\\"roles\\\":[\\\"admins\\\"]},\\\"members\\\":{\\\"names\\\":\n[\\\"user1\\\",\\\"user2\\\"],\\\"roles\\\": [\\\"developers\\\"]}}'\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000133-DB-000362\"\n  tag \"gid\": \"V-58129\"\n  tag \"rid\": \"SV-72559r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000133-DB-000362\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001499\"]\n  tag \"nist\": [\"CM-5 (6)\", \"Rev_4\"]\n\n  roles = input('approved_users')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/' + database + '/_security') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58129.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couchdba\"","run_time":0.0659402,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"admin\"","run_time":0.0557902,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couch_user\"","run_time":0.0555413,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58133","title":"The DBMS must disable network functions, ports, protocols, and\nservices deemed by the organization to be nonsecure, in accord with the Ports,\nProtocols, and Services Management (PPSM) guidance.","desc":"Use of nonsecure network functions, ports, protocols, and services\nexposes the system to avoidable threats.","descriptions":[{"label":"default","data":"Use of nonsecure network functions, ports, protocols, and services\nexposes the system to avoidable threats."},{"label":"check","data":"Review the organization-defined network functions, ports, protocols, and\nservices deemed by to be nonsecure, in accord with the Ports, Protocols, and\nServices Management (PPSM) guidance.\n\n    # find . -name \"default.ini\"\t\n    # grep httpd section\n    # grep port\n\n    If any protocol is prohibited by the PPSM guidance and is enabled, this is\na finding."},{"label":"fix","data":"Disable nonsecure network functions, ports, protovols, and\nservies."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000383-DB-000364","gid":"V-58133","rid":"SV-72563r1_rule","stig_id":"SRG-APP-000383-DB-000364","fix_id":null,"cci":["CCI-001762"],"nist":["CM-7 (1) (b)","Rev_4"]},"code":"control \"V-58133\" do\n  title \"The DBMS must disable network functions, ports, protocols, and\nservices deemed by the organization to be nonsecure, in accord with the Ports,\nProtocols, and Services Management (PPSM) guidance.\"\n  desc  \"Use of nonsecure network functions, ports, protocols, and services\nexposes the system to avoidable threats.\"\n  desc  \"check\", \"\n    Review the organization-defined network functions, ports, protocols, and\nservices deemed by to be nonsecure, in accord with the Ports, Protocols, and\nServices Management (PPSM) guidance.\n\n    # find . -name \\\"default.ini\\\"\\t\n    # grep httpd section\n    # grep port\n\n    If any protocol is prohibited by the PPSM guidance and is enabled, this is\na finding.\n\n  \"\n  desc  \"fix\", \"Disable nonsecure network functions, ports, protovols, and\nservies.\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000383-DB-000364\"\n  tag \"gid\": \"V-58133\"\n  tag \"rid\": \"SV-72563r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000383-DB-000364\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001762\"]\n  tag \"nist\": [\"CM-7 (1) (b)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('httpd.port') { should be_in input('authorized_ports') }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58133.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"INI /opt/couchdb/etc/default.ini httpd.port is expected to be in \"80\" and \"443\"","run_time":0.0002842,"start_time":"2020-08-07T14:43:20-04:00","message":"expected `5986` to be in the list: `[\"80\", \"443\"]`"}]},{"id":"V-58135","title":"The DBMS must prohibit user installation of logic modules (stored\nprocedures, functions, triggers, views, etc.) without explicit privileged\nstatus.","desc":"Allowing regular users to install software, without explicit\nprivileges, creates the risk that untested or potentially malicious software\nwill be installed on the system. Explicit privileges (escalated or\nadministrative privileges) provide the regular user with explicit capabilities\nand control that exceed the rights of a regular user.\n\n    DBMS functionality and the nature and requirements of databases will vary;\nso while users are not permitted to install unapproved software, there may be\ninstances where the organization allows the user to install approved software\npackages such as from an approved software repository. The requirements for\nproduction servers will be more restrictive than those used for development and\nresearch.\n\n    The DBMS must enforce software installation by users based upon what types\nof software installations are permitted (e.g., updates and security patches to\nexisting software) and what types of installations are prohibited (e.g.,\nsoftware whose pedigree with regard to being potentially malicious is unknown\nor suspect) by the organization).\n\n    In the case of a database management system, this requirement covers stored\nprocedures, functions, triggers, views, etc.","descriptions":[{"label":"default","data":"Allowing regular users to install software, without explicit\nprivileges, creates the risk that untested or potentially malicious software\nwill be installed on the system. Explicit privileges (escalated or\nadministrative privileges) provide the regular user with explicit capabilities\nand control that exceed the rights of a regular user.\n\n    DBMS functionality and the nature and requirements of databases will vary;\nso while users are not permitted to install unapproved software, there may be\ninstances where the organization allows the user to install approved software\npackages such as from an approved software repository. The requirements for\nproduction servers will be more restrictive than those used for development and\nresearch.\n\n    The DBMS must enforce software installation by users based upon what types\nof software installations are permitted (e.g., updates and security patches to\nexisting software) and what types of installations are prohibited (e.g.,\nsoftware whose pedigree with regard to being potentially malicious is unknown\nor suspect) by the organization).\n\n    In the case of a database management system, this requirement covers stored\nprocedures, functions, triggers, views, etc."},{"label":"check","data":"If CouchDB supports only software development, experimentation and/or\ndeveloper-level testing (that is, excluding production systems, integration\ntesting, stress testing, and user acceptance testing), this is not a finding.\n\n    Review CouchDB and database security settings with respect to\nnon-administrative users' ability to create, alter, or replace logic modules,\nto include but not necessarily only stored procedures, functions, triggers, and\nviews.\n\n    To list the privileges for all tables and schemas, as the database\nadministrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding."},{"label":"fix","data":"Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\"admins\":{\"names\":[\"superuser\"],\"roles\":[\"admins\"]},\"members\":{\"names\":\n[\"user1\",\"user2\"],\"roles\": [\"developers\"]}}'"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000378-DB-000365","gid":"V-58135","rid":"SV-72565r1_rule","stig_id":"SRG-APP-000378-DB-000365","fix_id":null,"cci":["CCI-001812"],"nist":["CM-11 (2)","Rev_4"]},"code":"control \"V-58135\" do\n  title \"The DBMS must prohibit user installation of logic modules (stored\nprocedures, functions, triggers, views, etc.) without explicit privileged\nstatus.\"\n  desc  \"Allowing regular users to install software, without explicit\nprivileges, creates the risk that untested or potentially malicious software\nwill be installed on the system. Explicit privileges (escalated or\nadministrative privileges) provide the regular user with explicit capabilities\nand control that exceed the rights of a regular user.\n\n    DBMS functionality and the nature and requirements of databases will vary;\nso while users are not permitted to install unapproved software, there may be\ninstances where the organization allows the user to install approved software\npackages such as from an approved software repository. The requirements for\nproduction servers will be more restrictive than those used for development and\nresearch.\n\n    The DBMS must enforce software installation by users based upon what types\nof software installations are permitted (e.g., updates and security patches to\nexisting software) and what types of installations are prohibited (e.g.,\nsoftware whose pedigree with regard to being potentially malicious is unknown\nor suspect) by the organization).\n\n    In the case of a database management system, this requirement covers stored\nprocedures, functions, triggers, views, etc.\n  \"\n  desc  \"check\", \"\n    If CouchDB supports only software development, experimentation and/or\ndeveloper-level testing (that is, excluding production systems, integration\ntesting, stress testing, and user acceptance testing), this is not a finding.\n\n    Review CouchDB and database security settings with respect to\nnon-administrative users' ability to create, alter, or replace logic modules,\nto include but not necessarily only stored procedures, functions, triggers, and\nviews.\n\n    To list the privileges for all tables and schemas, as the database\nadministrator, run the following:\n     #GET /db/_security\n\n    If the privileges are exceed what user and groups should have, this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Use the following command to set privileges correctly:\n\n    # PUT /{db}/_security\n\n    Example request:\n    shell> curl http://localhost:5984/pineapple/_security -X PUT -H\n'content-type: application/json' -H 'accept: application/json' -d\n'{\\\"admins\\\":{\\\"names\\\":[\\\"superuser\\\"],\\\"roles\\\":[\\\"admins\\\"]},\\\"members\\\":{\\\"names\\\":\n[\\\"user1\\\",\\\"user2\\\"],\\\"roles\\\": [\\\"developers\\\"]}}'\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000378-DB-000365\"\n  tag \"gid\": \"V-58135\"\n  tag \"rid\": \"SV-72565r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000378-DB-000365\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001812\"]\n  tag \"nist\": [\"CM-11 (2)\", \"Rev_4\"]\n\n  roles = input('approved_users')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/' + database + '/_security') do\n    its('stdout') { should include role }\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58135.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couchdba\"","run_time":0.0559799,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"admin\"","run_time":0.0665538,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couch_user\"","run_time":0.0554597,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58137","title":"The DBMS must prohibit the use of cached authenticators after an\norganization-defined time period.","desc":"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.","descriptions":[{"label":"default","data":"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable."},{"label":"check","data":"Review system settings to determine whether the organization-defined limit\nfor cached authentication is implemented.\n    Check for the following:\n\n    # find . -name \"local.ini\"\n\n    #grep couch_httpd_auth section. Verify that the auth_cache_size\nvariable is set to 50 or has a defined limit.\n\n    If it is not implemented, this is a finding."},{"label":"fix","data":"Modify system settings to implement the organization-defined limit on the\nlifetime of cached authenticators.\n    # find . -name \"local.ini\"\n    # grep couch_httpd_auth section <local.ini path>\n    # Set the auth_cache_size variable = 50"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000400-DB-000367","gid":"V-58137","rid":"SV-72567r1_rule","stig_id":"SRG-APP-000400-DB-000367","fix_id":null,"cci":["CCI-002007"],"nist":["IA-5 (13)","Rev_4"]},"code":"control \"V-58137\" do\n  title \"The DBMS must prohibit the use of cached authenticators after an\norganization-defined time period.\"\n  desc  \"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.\"\n  desc  \"check\", \"\n     Review system settings to determine whether the organization-defined limit\nfor cached authentication is implemented.\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n\n    #grep couch_httpd_auth section. Verify that the auth_cache_size\nvariable is set to 50 or has a defined limit.\n\n    If it is not implemented, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Modify system settings to implement the organization-defined limit on the\nlifetime of cached authenticators.\n    # find . -name \\\"local.ini\\\"\n    # grep couch_httpd_auth section <local.ini path>\n    # Set the auth_cache_size variable = 50\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000400-DB-000367\"\n  tag \"gid\": \"V-58137\"\n  tag \"rid\": \"SV-72567r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000400-DB-000367\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002007\"]\n  tag \"nist\": [\"IA-5 (13)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('couch_httpd_auth.auth_cache_size') { cmp 50 }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58137.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couch_httpd_auth.auth_cache_size ","run_time":0.0001186,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58149","title":"The DBMS must prevent unauthorized and unintended information transfer\nvia shared system resources.","desc":"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse.","descriptions":[{"label":"default","data":"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse."},{"label":"check","data":"Review CouchDB architecture to find out if and how it protects the private\nresources of one process or user (such as working memory, temporary tables,\nuncommitted data) from unauthorized access by another user or process.\n    Check for the following:\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If enable is not set to true, this is a finding."},{"label":"fix","data":"Deploy a DBMS capable of effectively protecting the private resources of\none process or user from unauthorized access by another user or process.\n\n    Configure CouchDB to effectively protect the private resources of one\nprocess or user from unauthorized access by another user or process."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000243-DB-000373","gid":"V-58149","rid":"SV-72579r1_rule","stig_id":"SRG-APP-000243-DB-000373","fix_id":null,"cci":["CCI-001090"],"nist":["SC-4","Rev_4"]},"code":"control \"V-58149\" do\n  title \"The DBMS must prevent unauthorized and unintended information transfer\nvia shared system resources.\"\n  desc  \"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse.\"\n  desc  \"check\", \"\n    Review CouchDB architecture to find out if and how it protects the private\nresources of one process or user (such as working memory, temporary tables,\nuncommitted data) from unauthorized access by another user or process.\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If enable is not set to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Deploy a DBMS capable of effectively protecting the private resources of\none process or user from unauthorized access by another user or process.\n\n    Configure CouchDB to effectively protect the private resources of one\nprocess or user from unauthorized access by another user or process.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000243-DB-000373\"\n  tag \"gid\": \"V-58149\"\n  tag \"rid\": \"SV-72579r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000243-DB-000373\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001090\"]\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58149.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":0.0003054,"start_time":"2020-08-07T14:43:20-04:00"}]},{"id":"V-58151","title":"Access to database files must be limited to relevant processes and to\nauthorized, administrative users.","desc":"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation.","descriptions":[{"label":"default","data":"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation."},{"label":"check","data":"Review the permissions granted to users by the operating system/file system\non the database files, database log files and database backup files.\n    Check for the following:\n\n    Execute the command #GET /db/_security\n    Verify the admins are authorized, administrative users. If not, this is a\nfinding.\n    # find .-name \"default.ini\"\n    # grep \"admin_only_all_dbs\" default.ini\n    If this is commented out, or not set equal to true, this is a finding."},{"label":"fix","data":"Configure the permissions granted by the operating system/file system on\nthe database files, database log files, and database backup files so that only\nrelevant system accounts and authorized system administrators and database\nadministrators with a need to know are permitted to read/view these files.\n    # find .-name \"default.ini\"\n    # grep \"admin_only_all_dbs\" default.ini"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000243-DB-000374","gid":"V-58151","rid":"SV-72581r1_rule","stig_id":"SRG-APP-000243-DB-000374","fix_id":null,"cci":["CCI-001090"],"nist":["SC-4","Rev_4"]},"code":"control \"V-58151\" do\n  title \"Access to database files must be limited to relevant processes and to\nauthorized, administrative users.\"\n  desc  \"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation.\"\n  desc  \"check\", \"\n    Review the permissions granted to users by the operating system/file system\non the database files, database log files and database backup files.\n    Check for the following:\n\n    Execute the command #GET /db/_security\n    Verify the admins are authorized, administrative users. If not, this is a\nfinding.\n    # find .-name \\\"default.ini\\\"\n    # grep \\\"admin_only_all_dbs\\\" default.ini\n    If this is commented out, or not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure the permissions granted by the operating system/file system on\nthe database files, database log files, and database backup files so that only\nrelevant system accounts and authorized system administrators and database\nadministrators with a need to know are permitted to read/view these files.\n    # find .-name \\\"default.ini\\\"\n    # grep \\\"admin_only_all_dbs\\\" default.ini\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000243-DB-000374\"\n  tag \"gid\": \"V-58151\"\n  tag \"rid\": \"SV-72581r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000243-DB-000374\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001090\"]\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n\n  roles = input('approved_users')\n\n  admin_name = input('couchdb_admin')\n\n  admin_pass = input ('couchdb_adminpass')\n\n  database = input('couchdb_db')\n\n  port = input('couch_port')\n  host = input('couch_host')\n  roles.each do |role|\n    describe command('curl -X GET ' + admin_name + ':' + admin_pass + '@' + host + ':' + port + '/' + database + '/_security') do\n    its('stdout') { should include role }\n    end\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n      its ('chttpd.admin_only_all_dbs') { should eq 'true'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58151.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couchdba\"","run_time":0.0553759,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"admin\"","run_time":0.0576838,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"Command: `curl -X GET admin:mysecretpassword@127.0.0.1:5984/test_db/_security` stdout is expected to include \"couch_user\"","run_time":0.0560409,"start_time":"2020-08-07T14:43:20-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini chttpd.admin_only_all_dbs is expected to eq \"true\"","run_time":0.0001558,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58153","title":"The DBMS must maintain the confidentiality and integrity of\ninformation during preparation for transmission.","desc":"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms.","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms."},{"label":"check","data":"Check for the following:\n\n# find . -name \"local.ini\"\n# grep \"ssl section\"\n# grep \"enable =\"\nIf this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000441-DB-000378","gid":"V-58153","rid":"SV-72583r1_rule","stig_id":"SRG-APP-000441-DB-000378","fix_id":null,"cci":["CCI-002420"],"nist":["SC-8 (2)","Rev_4"]},"code":"control \"V-58153\" do\n  title \"The DBMS must maintain the confidentiality and integrity of\ninformation during preparation for transmission.\"\n  desc  \"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000441-DB-000378\"\n  tag \"gid\": \"V-58153\"\n  tag \"rid\": \"SV-72583r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000441-DB-000378\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002420\"]\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58153.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":0.0001075,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58155","title":"The DBMS must maintain the confidentiality and integrity of\ninformation during reception.","desc":"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms.","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms."},{"label":"check","data":"Check for the following:\n\n# find . -name \"local.ini\"\n# grep \"ssl section\"\n# grep \"enable =\"\nIf this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000442-DB-000379","gid":"V-58155","rid":"SV-72585r1_rule","stig_id":"SRG-APP-000442-DB-000379","fix_id":null,"cci":["CCI-002422"],"nist":["SC-8 (2)","Rev_4"]},"code":"control \"V-58155\" do\n  title \"The DBMS must maintain the confidentiality and integrity of\ninformation during reception.\"\n  desc  \"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000442-DB-000379\"\n  tag \"gid\": \"V-58155\"\n  tag \"rid\": \"SV-72585r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000442-DB-000379\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002422\"]\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58155.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":7.2e-05,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58157","title":"The DBMS must use NSA-approved cryptography to protect classified\ninformation in accordance with the data owners requirements.","desc":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices."},{"label":"check","data":"If CouchDB is deployed in an unclassified environment, this is not\napplicable (NA).\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000416-DB-000380","gid":"V-58157","rid":"SV-72587r1_rule","stig_id":"SRG-APP-000416-DB-000380","fix_id":null,"cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58157\" do\n  title \"The DBMS must use NSA-approved cryptography to protect classified\ninformation in accordance with the data owners requirements.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices.\n  \"\n  desc  \"check\", \"\n    If CouchDB is deployed in an unclassified environment, this is not\napplicable (NA).\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000416-DB-000380\"\n  tag \"gid\": \"V-58157\"\n  tag \"rid\": \"SV-72587r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000416-DB-000380\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58157.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":9.68e-05,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58161","title":"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to generate and validate cryptographic hashes.","desc":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant."},{"label":"check","data":"Check for the following:\n# find . -name \"local.ini\"\n\n# cat /proc/sys/crypto/fips_enabled\nVerify that the response of fips_enabled is 1.\n\nIf it is not 1, this is a finding."},{"label":"fix","data":"Configure OpenSSL to be FIPS compliant.\n# sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000514-DB-000382","gid":"V-58161","rid":"SV-72591r1_rule","stig_id":"SRG-APP-000514-DB-000382","fix_id":null,"cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58161\" do\n  title \"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to generate and validate cryptographic hashes.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n    # find . -name \\\"local.ini\\\"\n\n    # cat /proc/sys/crypto/fips_enabled\n    Verify that the response of fips_enabled is 1.\n\n    If it is not 1, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure OpenSSL to be FIPS compliant.\n    # sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000514-DB-000382\"\n  tag \"gid\": \"V-58161\"\n  tag \"rid\": \"SV-72591r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000514-DB-000382\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe kernel_parameter('crypto.fips_enabled') do\n    its('value') { should cmp 1 }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58161.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter crypto.fips_enabled value is expected to cmp == 1","run_time":0.0460136,"start_time":"2020-08-07T14:43:21-04:00","message":"\nexpected: 1\n     got: 0\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-58163","title":"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to protect unclassified information requiring confidentiality and\ncryptographic protection, in accordance with the data owners requirements.","desc":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant."},{"label":"check","data":"Check for the following:\n# find . -name \"local.ini\"\n\n# cat /proc/sys/crypto/fips_enabled\nVerify that the response of fips_enabled is 1.\n\nIf it is not 1 , this is a finding."},{"label":"fix","data":"Configure OpenSSL to be FIPS compliant.\n# sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000514-DB-000383","gid":"V-58163","rid":"SV-72593r1_rule","stig_id":"SRG-APP-000514-DB-000383","fix_id":null,"cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58163\" do\n  title \"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to protect unclassified information requiring confidentiality and\ncryptographic protection, in accordance with the data owners requirements.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n    # find . -name \\\"local.ini\\\"\n\n    # cat /proc/sys/crypto/fips_enabled\n    Verify that the response of fips_enabled is 1.\n\n    If it is not 1 , this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure OpenSSL to be FIPS compliant.\n    # sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000514-DB-000383\"\n  tag \"gid\": \"V-58163\"\n  tag \"rid\": \"SV-72593r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000514-DB-000383\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe kernel_parameter('crypto.fips_enabled') do\n    its('value') { should cmp 1 }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58163.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter crypto.fips_enabled value is expected to cmp == 1","run_time":0.0442448,"start_time":"2020-08-07T14:43:21-04:00","message":"\nexpected: 1\n     got: 0\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-58165","title":"The DBMS must maintain the authenticity of communications sessions by\nguarding against man-in-the-middle attacks that guess at Session ID values.","desc":"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective.","descriptions":[{"label":"default","data":"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective."},{"label":"check","data":"Review DBMS vendor documentation and system behavior (and if necessary,\nconsult vendor representatives) to determine whether CouchDB can provide\ndemonstrably effective protection against man-in-the-middle attacks that guess\nat session identifier values.\n\n    Review DBMS settings to determine whether protections against\nman-in-the-middle attacks that guess at session identifier values are enabled.\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000224-DB-000384","gid":"V-58165","rid":"SV-72595r1_rule","stig_id":"SRG-APP-000224-DB-000384","fix_id":null,"cci":["CCI-001188"],"nist":["SC-23 (3)","Rev_4"]},"code":"control \"V-58165\" do\n  title \"The DBMS must maintain the authenticity of communications sessions by\nguarding against man-in-the-middle attacks that guess at Session ID values.\"\n  desc  \"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective.\n  \"\n  desc  \"check\", \"\n     Review DBMS vendor documentation and system behavior (and if necessary,\nconsult vendor representatives) to determine whether CouchDB can provide\ndemonstrably effective protection against man-in-the-middle attacks that guess\nat session identifier values.\n\n    Review DBMS settings to determine whether protections against\nman-in-the-middle attacks that guess at session identifier values are enabled.\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000224-DB-000384\"\n  tag \"gid\": \"V-58165\"\n  tag \"rid\": \"SV-72595r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000224-DB-000384\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001188\"]\n  tag \"nist\": [\"SC-23 (3)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58165.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":0.0002768,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58167","title":"The DBMS must only accept end entity certificates issued by DoD PKI or\nDoD-approved PKI Certification Authorities (CAs) for the establishment of all\nencrypted sessions.","desc":"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet.","descriptions":[{"label":"default","data":"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet."},{"label":"check","data":"Check for the following:\n    # find . -name \"local.ini\"\n\n    #grep ssl section\n    Verify \"enabled = true\"\n    #grep \"cert_file = /etc/couchdb/cert/couchdb.pem\"\n    Verify for certificates issued by DoD PKI or DoD-approved PKI Certification\nAuthorities (CAs)\n\n    If CouchDB will accept non-DoD approved PKI end-entity certificates, this\nis a finding"},{"label":"fix","data":"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority. Configure CouchDB to accept only DoD and DoD-approved\nPKI end-entity certificates."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000427-DB-000385","gid":"V-58167","rid":"SV-72597r1_rule","stig_id":"SRG-APP-000427-DB-000385","fix_id":null,"cci":["CCI-002470"],"nist":["SC-23 (5)","Rev_4"]},"code":"control \"V-58167\" do\n  title \"The DBMS must only accept end entity certificates issued by DoD PKI or\nDoD-approved PKI Certification Authorities (CAs) for the establishment of all\nencrypted sessions.\"\n  desc  \"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n    # find . -name \\\"local.ini\\\"\n\n    #grep ssl section\n    Verify \\\"enabled = true\\\"\n    #grep \\\"cert_file = /etc/couchdb/cert/couchdb.pem\\\"\n    Verify for certificates issued by DoD PKI or DoD-approved PKI Certification\nAuthorities (CAs)\n\n    If CouchDB will accept non-DoD approved PKI end-entity certificates, this\nis a finding\n  \"\n  desc  \"fix\", \"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority. Configure CouchDB to accept only DoD and DoD-approved\nPKI end-entity certificates.\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000427-DB-000385\"\n  tag \"gid\": \"V-58167\"\n  tag \"rid\": \"SV-72597r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000427-DB-000385\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002470\"]\n  tag \"nist\": [\"SC-23 (5)\", \"Rev_4\"]\n\n  \n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n    its('ssl.cert_file') {should eq '/etc/couchdb/cert/couchdb.pem'}\n    its('ssl.key_file') {should eq '/etc/couchdb/cert/privkey.pem'}\n  end\n\n  describe file(input('couchdbpem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end\n\n  describe file(input('privkeypem')) do\n    it { should exist }\n    its ('mode') { should be 0600 }\n  end \n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58167.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":0.000131,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cert_file is expected to eq \"/etc/couchdb/cert/couchdb.pem\"","run_time":7.74e-05,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.key_file is expected to eq \"/etc/couchdb/cert/privkey.pem\"","run_time":8.36e-05,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem is expected to exist","run_time":0.0438263,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/couchdb.pem mode is expected to equal 384","run_time":0.0454606,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem is expected to exist","run_time":0.0439024,"start_time":"2020-08-07T14:43:21-04:00"},{"status":"passed","code_desc":"File /etc/couchdb/cert/privkey.pem mode is expected to equal 384","run_time":0.0446914,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58175","title":"When updates are applied to the DBMS software, any software components\nthat have been replaced or made unnecessary must be removed.","desc":"Previous versions of DBMS components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries.\n\n    Some DBMSs' installation tools may remove older versions of software\nautomatically from the information system. In other cases, manual review and\nremoval will be required. In planning installations and upgrades, organizations\nmust include steps (automated, manual, or both) to identify and remove the\noutdated modules.\n\n    A transition period may be necessary when both the old and the new software\nare required. This should be taken into account in the planning.","descriptions":[{"label":"default","data":"Previous versions of DBMS components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries.\n\n    Some DBMSs' installation tools may remove older versions of software\nautomatically from the information system. In other cases, manual review and\nremoval will be required. In planning installations and upgrades, organizations\nmust include steps (automated, manual, or both) to identify and remove the\noutdated modules.\n\n    A transition period may be necessary when both the old and the new software\nare required. This should be taken into account in the planning."},{"label":"check","data":"Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    To check software installed by packages, as the system administrator, run\nthe following command:\n\n    # RHEL/CENT Systems\n    $ sudo rpm -qa | grep couchdb\n\n    If multiple versions of couchdb are installed but are unused, this is a\nfinding."},{"label":"fix","data":"Use package managers (RPM or apt-get) for installing CouchDB.\nUnused software is removed when updated."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000454-DB-000389","gid":"V-58175","rid":"SV-72605r1_rule","stig_id":"SRG-APP-000454-DB-000389","fix_id":null,"cci":["CCI-002617"],"nist":["SI-2 (6)","Rev_4"]},"code":"control \"V-58175\" do\n  title \"When updates are applied to the DBMS software, any software components\nthat have been replaced or made unnecessary must be removed.\"\n  desc  \"Previous versions of DBMS components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries.\n\n    Some DBMSs' installation tools may remove older versions of software\nautomatically from the information system. In other cases, manual review and\nremoval will be required. In planning installations and upgrades, organizations\nmust include steps (automated, manual, or both) to identify and remove the\noutdated modules.\n\n    A transition period may be necessary when both the old and the new software\nare required. This should be taken into account in the planning.\n  \"\n  desc  \"check\", \"\n    Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    To check software installed by packages, as the system administrator, run\nthe following command:\n\n    # RHEL/CENT Systems\n    $ sudo rpm -qa | grep couchdb\n\n    If multiple versions of couchdb are installed but are unused, this is a\nfinding.\n  \"\n  desc  \"fix\", \"Use package managers (RPM or apt-get) for installing CouchDB.\nUnused software is removed when updated.\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000454-DB-000389\"\n  tag \"gid\": \"V-58175\"\n  tag \"rid\": \"SV-72605r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000454-DB-000389\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002617\"]\n  tag \"nist\": [\"SI-2 (6)\", \"Rev_4\"]\n\n  if os.debian?\n    dpkg_packages = command(\"apt list --installed | grep \\\"couchdb\\\"\").stdout.split(\"\\n\")\n    dpkg_packages.each do |packages|\n      describe(packages) do\n        it { should match input('couchdb_version') }\n      end\n    end\n\n  elsif os.linux? || os.redhat?\n    rpm_packages = command(\"rpm -qa | grep \\\"couchdb\\\"\").stdout.split(\"\\n\")\n\n    rpm_packages.each do |packages|\n      describe(packages) do\n        it { should match input('couchdb_version') }\n      end\n    end\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58175.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"couchdb-3.1.0-1.el7.x86_64 is expected to match \"3.1.0\"","run_time":0.0001711,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58177","title":"Security-relevant software updates to the DBMS must be installed\nwithin the time period directed by an authoritative source (e.g. IAVM, CTOs,\nDTMs, and STIGs).","desc":"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).","descriptions":[{"label":"default","data":"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs)."},{"label":"check","data":"Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    Execute the following in the command line: curl [http address]\n    Verify the version is the most recent version"},{"label":"fix","data":"Update version of CouchDB"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000456-DB-000390","gid":"V-58177","rid":"SV-72607r1_rule","stig_id":"SRG-APP-000456-DB-000390","fix_id":"F-63385r1_fix","cci":["CCI-002605"],"nist":["SI-2 c","Rev_4"]},"code":"control \"V-58177\" do\n  title \"Security-relevant software updates to the DBMS must be installed\nwithin the time period directed by an authoritative source (e.g. IAVM, CTOs,\nDTMs, and STIGs).\"\n  desc  \"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).\n  \"\n  desc  \"check\", \"\n    Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    Execute the following in the command line: curl [http address]\n    Verify the version is the most recent version\n  \"\n  desc  \"fix\", 'Update version of CouchDB'\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000456-DB-000390\"\n  tag \"gid\": \"V-58177\"\n  tag \"rid\": \"SV-72607r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000456-DB-000390\"\n  tag \"fix_id\": \"F-63385r1_fix\"\n  tag \"cci\": [\"CCI-002605\"]\n  tag \"nist\": [\"SI-2 c\", \"Rev_4\"]\n\n  describe command('curl http://127.0.0.1:5984/') do \n    its('stdout') { should include input('couchdb_version') }\n    \n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58177.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl http://127.0.0.1:5984/` stdout is expected to include \"3.1.0\"","run_time":0.0555861,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-58183","title":"When invalid inputs are received, the DBMS must behave in a\npredictable and documented manner that reflects organizational and system\nobjectives.","desc":"A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.\n\n    This calls for inspection of application source code, which will require\ncollaboration with the application developers. It is recognized that in many\ncases, the database administrator (DBA) is organizationally separate from the\napplication developers, and may have limited, if any, access to source code.\nNevertheless, protections of this type are so important to the secure operation\nof databases that they must not be ignored. At a minimum, the DBA must attempt\nto obtain assurances from the development organization that this issue has been\naddressed, and must document what has been discovered.","descriptions":[{"label":"default","data":"A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.\n\n    This calls for inspection of application source code, which will require\ncollaboration with the application developers. It is recognized that in many\ncases, the database administrator (DBA) is organizationally separate from the\napplication developers, and may have limited, if any, access to source code.\nNevertheless, protections of this type are so important to the secure operation\nof databases that they must not be ignored. At a minimum, the DBA must attempt\nto obtain assurances from the development organization that this issue has been\naddressed, and must document what has been discovered."},{"label":"check","data":"Review system documentation to determine how input errors are to be handled\nin general and if any special handling is defined for specific circumstances.\n\n    Review the source code for database program objects (stored procedures,\nfunctions, triggers) and application source code to identify how the system\nresponds to invalid input.\n\n    As database administrator, make a small syntax error:\n    Example command:\n    GT /_all_dbs\n     Verify the syntax error was logged:\n     # find . -name \"default.ini\"\n        # grep \"file =\" <path to default.ini>\n              if line does not exist or is commented out, this is a finding.\n     #grep \"level =\" <path to default.ini>\n              if line does not exist or is not set to info, this is a finding.\n\n\n    If it does not implement the documented behavior, this is a finding."},{"label":"fix","data":"Configure CouchDB to generate audit records for all invalid inputs.\n# find . -name \"default.ini\"\n# set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000447-DB-000393","gid":"V-58183","rid":"SV-72613r2_rule","stig_id":"SRG-APP-000447-DB-000393","fix_id":"F-63391r1_fix","cci":["CCI-002754"],"nist":["SI-10 (3)","Rev_4"]},"code":"control \"V-58183\" do\n  title \"When invalid inputs are received, the DBMS must behave in a\npredictable and documented manner that reflects organizational and system\nobjectives.\"\n  desc  \"A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.\n\n    This calls for inspection of application source code, which will require\ncollaboration with the application developers. It is recognized that in many\ncases, the database administrator (DBA) is organizationally separate from the\napplication developers, and may have limited, if any, access to source code.\nNevertheless, protections of this type are so important to the secure operation\nof databases that they must not be ignored. At a minimum, the DBA must attempt\nto obtain assurances from the development organization that this issue has been\naddressed, and must document what has been discovered.\n  \"\n  desc  \"check\", \"\n    Review system documentation to determine how input errors are to be handled\nin general and if any special handling is defined for specific circumstances.\n\n    Review the source code for database program objects (stored procedures,\nfunctions, triggers) and application source code to identify how the system\nresponds to invalid input.\n\n    As database administrator, make a small syntax error:\n    Example command:\n    GT /_all_dbs\n     Verify the syntax error was logged:\n     # find . -name \\\"default.ini\\\"\n        # grep \\\"file =\\\" <path to default.ini>\n              if line does not exist or is commented out, this is a finding.\n     #grep \\\"level =\\\" <path to default.ini>\n              if line does not exist or is not set to info, this is a finding.\n\n\n    If it does not implement the documented behavior, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to generate audit records for all invalid inputs.\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000447-DB-000393\"\n  tag \"gid\": \"V-58183\"\n  tag \"rid\": \"SV-72613r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000447-DB-000393\"\n  tag \"fix_id\": \"F-63391r1_fix\"\n  tag \"cci\": [\"CCI-002754\"]\n  tag \"nist\": [\"SI-10 (3)\", \"Rev_4\"]\n\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58183.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0001478,"start_time":"2020-08-07T14:43:21-04:00"}]},{"id":"V-61407","title":"If DBMS authentication, using passwords, is employed, the DBMS must\nenforce the DoD standards for password complexity and lifetime.","desc":"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code.","descriptions":[{"label":"default","data":"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code."},{"label":"check","data":"Review CouchDB settings relating to password complexity. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n\n    Review CouchDB settings relating to password lifetime. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n    # find . -name \"local.ini\"\n\n    # grep \"file =\" <path to local.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n\n    Verify that the password follows the PBKDF2 (RFC-2898) algorithm"},{"label":"fix","data":"Restart the CouchDB services.\n# sudo restart couchdb"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000164-DB-000401","gid":"V-61407","rid":"SV-75897r3_rule","stig_id":"SRG-APP-000164-DB-000401","fix_id":"F-67323r7_fix","cci":["CCI-000192"],"nist":["IA-5 (1) (a)","Rev_4"]},"code":"control \"V-61407\" do\n  title \"If DBMS authentication, using passwords, is employed, the DBMS must\nenforce the DoD standards for password complexity and lifetime.\"\n  desc  \"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code.\n  \"\n  desc  \"check\", \"\n    Review CouchDB settings relating to password complexity. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n\n    Review CouchDB settings relating to password lifetime. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n    # find . -name \\\"local.ini\\\"\n\n    # grep \\\"file =\\\" <path to local.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n\n    Verify that the password follows the PBKDF2 (RFC-2898) algorithm\n\n  \"\n  desc  \"fix\", \"\n    Restart the CouchDB services.\n    # sudo restart couchdb\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000164-DB-000401\"\n  tag \"gid\": \"V-61407\"\n  tag \"rid\": \"SV-75897r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000164-DB-000401\"\n  tag \"fix_id\": \"F-67323r7_fix\"\n  tag \"cci\": [\"CCI-000192\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n\n  \n\n  describe ini(input('couchdb_conf_local')) do\n    its('admins.admin') { should match '-pbkdf2-' }\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-61407.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini admins.admin is expected to match \"-pbkdf2-\"","run_time":0.0001308,"start_time":"2020-08-07T14:43:21-04:00"}]}],"status":"loaded"}],"statistics":{"duration":2.3605022},"version":"4.21.3"}