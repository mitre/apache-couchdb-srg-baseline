{"platform":{"name":"centos","release":"7.8.2003"},"profiles":[{"name":"tests from {:path=>\"C:.Users.zhangc.git.apache-couchdb-srg-baseline.controls\"}","sha256":"6cbc8fd6a825e963286a23334db7b7cc4581a6bfa24a41cf7914db48e91129f8","title":"tests from {:path=>\"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls\"}","supports":[],"attributes":[{"name":"couchdb_conf_local","options":{"value":"/opt/couchdb/etc/local.ini"}},{"name":"couchdb_conf_default","options":{"value":"/opt/couchdb/etc/default.ini"}}],"groups":[{"id":"V-32475.rb","controls":["V-32475"]},{"id":"V-32480.rb","controls":["V-32480"]},{"id":"V-32523.rb","controls":["V-32523"]},{"id":"V-58049.rb","controls":["V-58049"]},{"id":"V-58051.rb","controls":["V-58051"]},{"id":"V-58055.rb","controls":["V-58055"]},{"id":"V-58059.rb","controls":["V-58059"]},{"id":"V-58063.rb","controls":["V-58063"]},{"id":"V-58065.rb","controls":["V-58065"]},{"id":"V-58123.rb","controls":["V-58123"]},{"id":"V-58127.rb","controls":["V-58127"]},{"id":"V-58137.rb","controls":["V-58137"]},{"id":"V-58149.rb","controls":["V-58149"]},{"id":"V-58151.rb","controls":["V-58151"]},{"id":"V-58153.rb","controls":["V-58153"]},{"id":"V-58155.rb","controls":["V-58155"]},{"id":"V-58157.rb","controls":["V-58157"]},{"id":"V-58163.rb","controls":["V-58163"]},{"id":"V-58165.rb","controls":["V-58165"]},{"id":"V-58167.rb","controls":["V-58167"]},{"id":"V-58177.rb","controls":["V-58177"]},{"id":"V-61407.rb","controls":["V-61407"]}],"controls":[{"id":"V-32475","title":"The DBMS, when utilizing PKI-based authentication, must validate\ncertificates by performing RFC 5280-compliant certification path validation.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate’s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database.","descriptions":[{"label":"default","data":"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate’s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database."},{"label":"check","data":"# find local.ini\n    # grep \"cacert_file =\" <path to local.ini>\n    If cacert_file path does not exist, this is a finding.\n    # grep \"cert_file =\" <path to local.ini>\n    If cert_file path does not exist, this is a finding.\n    # grep \"secure_renegotiate\" <path to local.ini>\n    If commented out, or not set to true, this is a finding.\n\n    If certificates are not being validated by performing RFC 5280-compliant\ncertification path validation, this is a finding."},{"label":"fix","data":"# find local.ini\n    # set secure_renegotiate = true\n    # set cacert_file = <cert path>\n    # set cert_file = <cert path>\n\n    Verify certificates are being validated by performing RFC 5280-compliant\ncertification path validation."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000175-DB-000067","gid":"V-32475","rid":"SV-42812r3_rule","stig_id":"SRG-APP-000175-DB-000067","fix_id":"F-36390r3_fix","cci":["CCI-000185"],"nist":["IA-5 (2) (a)","Rev_4"]},"code":"control \"V-32475\" do\n  title \"The DBMS, when utilizing PKI-based authentication, must validate\ncertificates by performing RFC 5280-compliant certification path validation.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    A certificate\\xE2\\x80\\x99s certification path is the path from the end\nentity certificate to a trusted root certification authority (CA).\nCertification path validation is necessary for a relying party to make an\ninformed decision regarding acceptance of an end entity certificate.\nCertification path validation includes checks such as certificate issuer trust,\ntime validity and revocation status for each certificate in the certification\npath.  Revocation status information for CA and subject certificates in a\ncertification path is commonly provided via certificate revocation lists (CRLs)\nor online certificate status protocol (OCSP) responses.\n\n    Database Management Systems that do not validate certificates by performing\nRFC 5280-compliant certification path validation are in danger of accepting\ncertificates that are invalid and/or counterfeit. This could allow unauthorized\naccess to the database.\n  \"\n  desc  \"check\", \"\n    # find local.ini\n    # grep \\\"cacert_file =\\\" <path to local.ini>\n    If cacert_file path does not exist, this is a finding.\n    # grep \\\"cert_file =\\\" <path to local.ini>\n    If cert_file path does not exist, this is a finding.\n    # grep \\\"secure_renegotiate\\\" <path to local.ini>\n    If commented out, or not set to true, this is a finding.\n\n    If certificates are not being validated by performing RFC 5280-compliant\ncertification path validation, this is a finding.\n  \"\n  desc  \"fix\", \"\n    # find local.ini\n    # set secure_renegotiate = true\n    # set cacert_file = <cert path>\n    # set cert_file = <cert path>\n\n    Verify certificates are being validated by performing RFC 5280-compliant\ncertification path validation.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000175-DB-000067\"\n  tag \"gid\": \"V-32475\"\n  tag \"rid\": \"SV-42812r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000175-DB-000067\"\n  tag \"fix_id\": \"F-36390r3_fix\"\n  tag \"cci\": [\"CCI-000185\"]\n  tag \"nist\": [\"IA-5 (2) (a)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_local')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.secure_renegotiate') { should eq 'true' }\n    its('ssl.cert_file') {should eq '/etc/couchdb/cert/couchdb.pem'}\n    its('ssl.cacert_file') {should eq '/etc/ssl/certs/ca-certificates.crt'}\n\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32475.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/local.ini is expected to exist","run_time":0.0545044,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.secure_renegotiate is expected to eq \"true\"","run_time":0.0069943,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"failed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cert_file is expected to eq \"/etc/couchdb/cert/couchdb.pem\"","run_time":0.0519624,"start_time":"2020-07-24T10:58:02-04:00","message":"\nexpected: \"/etc/couchdb/cert/couchdb.pem\"\n     got: \"/full/path/to/server_cert.pem\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cacert_file is expected to eq \"/etc/ssl/certs/ca-certificates.crt\"","run_time":0.0001546,"start_time":"2020-07-24T10:58:02-04:00","message":"\nexpected: \"/etc/ssl/certs/ca-certificates.crt\"\n     got: \"/full/path/to/cacertf\"\n\n(compared using ==)\n"}]},{"id":"V-32480","title":"The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.","desc":"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.","descriptions":[{"label":"default","data":"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules."},{"label":"check","data":"As the system administrator, run the following:\n\n$ openssl version\n\nIf \"fips\" is not included in the openssl version, this is a finding."},{"label":"fix","data":"Configure OpenSSL to meet FIPS Compliance using the following documentation\nin section 9.1:\n\n    http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1758.pdf"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000179-DB-000114","gid":"V-32480","rid":"SV-42817r3_rule","stig_id":"SRG-APP-000179-DB-000114","fix_id":null,"cci":["CCI-000803"],"nist":["IA-7","Rev_4"]},"code":"control \"V-32480\" do\n  title \"The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.\"\n  desc  \"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.\n  \"\n  desc  \"check\", \"\n    As the system administrator, run the following:\n\n    $ openssl version\n\n    If \\\"fips\\\" is not included in the openssl version, this is a finding.\n\n  \"\n  desc  \"fix\", \"\n    Configure OpenSSL to meet FIPS Compliance using the following documentation\nin section 9.1:\n\n    http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1758.pdf\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000179-DB-000114\"\n  tag \"gid\": \"V-32480\"\n  tag \"rid\": \"SV-42817r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000179-DB-000114\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000803\"]\n  tag \"nist\": [\"IA-7\", \"Rev_4\"]\n\n  describe command('openssl version') do\n    its('stdout') { should match 'fips' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32480.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `openssl version` stdout is expected to match \"fips\"","run_time":0.0513346,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-32523","title":"The DBMS must invalidate session identifiers upon user logout or other\nsession termination.","desc":"Captured sessions can be reused in \"replay\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked.","descriptions":[{"label":"default","data":"Captured sessions can be reused in \"replay\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked."},{"label":"check","data":"Review DBMS settings and vendor documentation to verify user sessions are\nterminated, and session identifiers invalidated, upon user logout. If they are\nnot, this is a finding.\n\n    Review system documentation and organization policy to identify other\nevents that should result in session terminations.\n    # find . -name \"default.ini\"\n    #grep couch_httpd_auth\n    Verify the timeout variable has a set time\n    Ex:  timeout = 600\n    #grep \"couchdb\" section\n    #Verify \"os_process_timeout\" has a set time\n\n    If other session termination events are defined, review DBMS settings to\nverify occurrences of these events would cause session termination,\ninvalidating the session identifiers.\n\n    If occurrences of defined session terminating events do not cause session\nterminations, invalidating the session identifiers, this is a finding."},{"label":"fix","data":"Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon user logout.\n\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon the occurrence of any organization- or policy-defined session\ntermination event.\n    # Set timeout variable to be 600\n    # Set os_process_timeout to be 5000"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000220-DB-000149","gid":"V-32523","rid":"SV-42860r2_rule","stig_id":"SRG-APP-000220-DB-000149","fix_id":null,"cci":["CCI-001185"],"nist":["SC-23 (1)","Rev_4"]},"code":"control \"V-32523\" do\n  title \"The DBMS must invalidate session identifiers upon user logout or other\nsession termination.\"\n  desc  \"Captured sessions can be reused in \\\"replay\\\" attacks. This\nrequirement limits the ability of adversaries to capture and continue to employ\npreviously valid session IDs.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet. The intent of this control is to establish\ngrounds for confidence at each end of a communications session in the ongoing\nidentity of the other party and in the validity of the information being\ntransmitted.\n\n    Session IDs are tokens generated by DBMSs to uniquely identify a user's (or\nprocess's) session. DBMSs will make access decisions and execute logic based on\nthe session ID.\n\n    Unique session IDs help to reduce predictability of said identifiers.\nUnique session IDs address man-in-the-middle attacks, including session\nhijacking or insertion of false information into a session. If the attacker is\nunable to identify or guess the session information related to pending\napplication traffic, they will have more difficulty in hijacking the session or\notherwise manipulating valid sessions.\n\n    When a user logs out, or when any other session termination event occurs,\nthe DBMS must terminate the user session(s) to minimize the potential for\nsessions to be hijacked.\n  \"\n  desc  \"check\", \"\n    Review DBMS settings and vendor documentation to verify user sessions are\nterminated, and session identifiers invalidated, upon user logout. If they are\nnot, this is a finding.\n\n    Review system documentation and organization policy to identify other\nevents that should result in session terminations.\n    # find . -name \\\"default.ini\\\"\n    #grep couch_httpd_auth\n    Verify the timeout variable has a set time\n    Ex:  timeout = 600\n    #grep \\\"couchdb\\\" section\n    #Verify \\\"os_process_timeout\\\" has a set time\n\n    If other session termination events are defined, review DBMS settings to\nverify occurrences of these events would cause session termination,\ninvalidating the session identifiers.\n\n    If occurrences of defined session terminating events do not cause session\nterminations, invalidating the session identifiers, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon user logout.\n\n    Configure DBMS settings to terminate sessions, invalidating their session\nidentifiers, upon the occurrence of any organization- or policy-defined session\ntermination event.\n    # Set timeout variable to be 600\n    # Set os_process_timeout to be 5000\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000220-DB-000149\"\n  tag \"gid\": \"V-32523\"\n  tag \"rid\": \"SV-42860r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000220-DB-000149\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001185\"]\n  tag \"nist\": [\"SC-23 (1)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('couchdb_httpd_auth.timeout') { cmp >= 600 }\n    its('couchdb.os_process_timeout') { should_not be nil }\n\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-32523.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couchdb_httpd_auth.timeout ","run_time":0.000136,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couchdb.os_process_timeout is expected not to equal nil","run_time":0.0066979,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58049","title":"The DBMS must utilize centralized management of the content captured\nin audit records generated by all components of the DBMS.","desc":"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.","descriptions":[{"label":"default","data":"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system."},{"label":"check","data":"Review the system documentation for a description of how audit records are\noff-loaded and how local audit log space is managed.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep log section\n    #grep \"sys_facilities =\" <path to default.ini>\n    If the CouchDB audit records are not written directly to or systematically\ntransferred to a centralized log management system, this is a finding."},{"label":"fix","data":"Configure and/or deploy software tools to ensure that the\nCouchDB audit records are written directly to or systematically transferred to\na centralized log management system. Configure loging to be enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000356-DB-000314","gid":"V-58049","rid":"SV-72479r1_rule","stig_id":"SRG-APP-000356-DB-000314","fix_id":null,"cci":["CCI-001844"],"nist":["AU-3 (2)","Rev_4"]},"code":"control \"V-58049\" do\n  title \"The DBMS must utilize centralized management of the content captured\nin audit records generated by all components of the DBMS.\"\n  desc  \"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.\n  \"\n  desc  \"check\", \"\n    Review the system documentation for a description of how audit records are\noff-loaded and how local audit log space is managed.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep log section\n    #grep \\\"sys_facilities =\\\" <path to default.ini>\n    If the CouchDB audit records are not written directly to or systematically\ntransferred to a centralized log management system, this is a finding.\n  \"\n  desc  \"fix\", \"Configure and/or deploy software tools to ensure that the\nCouchDB audit records are written directly to or systematically transferred to\na centralized log management system. Configure loging to be enabled\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000356-DB-000314\"\n  tag \"gid\": \"V-58049\"\n  tag \"rid\": \"SV-72479r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000356-DB-000314\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001844\"]\n  tag \"nist\": [\"AU-3 (2)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.syslog_facility') { should_not be 'nil' }\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58049.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0544505,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.syslog_facility is expected not to equal \"nil\"","run_time":0.0002147,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58051","title":"The DBMS must provide centralized configuration of the content to be\ncaptured in audit records generated by all components of the DBMS.","desc":"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration.","descriptions":[{"label":"default","data":"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for centralized\nconfiguration of the content to be captured in audit records generated by all\ncomponents of the CouchDB database.\n\n    # find . -name \"default.ini\"\n\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log audit records for centralized configuration of the\ncontent to be captured in audit records generated by all components of the\nCouchDB database, this is a finding."},{"label":"fix","data":"Configure CouchDB to provide centralized configuration of the content to be\ncaptured in audit records generated by all components of CouchDB.\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000356-DB-000315","gid":"V-58051","rid":"SV-72481r1_rule","stig_id":"SRG-APP-000356-DB-000315","fix_id":null,"cci":["CCI-001844"],"nist":["AU-3 (2)","Rev_4"]},"code":"control \"V-58051\" do\n  title \"The DBMS must provide centralized configuration of the content to be\ncaptured in audit records generated by all components of the DBMS.\"\n  desc  \"If the configuration of the DBMS's auditing is spread across multiple\nlocations in the database management software, or across multiple commands,\nonly loosely related, it is harder to use and takes longer to reconfigure in\nresponse to events.\n\n    The DBMS must provide a unified tool for audit configuration.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for centralized\nconfiguration of the content to be captured in audit records generated by all\ncomponents of the CouchDB database.\n\n    # find . -name \\\"default.ini\\\"\n\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log audit records for centralized configuration of the\ncontent to be captured in audit records generated by all components of the\nCouchDB database, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to provide centralized configuration of the content to be\ncaptured in audit records generated by all components of CouchDB.\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000356-DB-000315\"\n  tag \"gid\": \"V-58051\"\n  tag \"rid\": \"SV-72481r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000356-DB-000315\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001844\"]\n  tag \"nist\": [\"AU-3 (2)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58051.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0443603,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0002137,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58055","title":"The DBMS must off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.","desc":"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.","descriptions":[{"label":"default","data":"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system."},{"label":"check","data":"Review the system documentation for a description of how audit records are\noff-loaded.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep 'syslog_facility'\n    Check with the organization to see how syslog facilities are defined in\ntheir organization.\n\n    If the wrong facility is configured, this is a finding.\n\n    If CouchDB has a continuous network connection to the centralized log\nmanagement system, but CouchDB audit records are not written directly to the\ncentralized log management system or transferred in near-real-time, this is a\nfinding.\n\n    If CouchDB does not have a continuous network connection to the centralized\nlog management system, and CouchDB audit records are not transferred to the\ncentralized log management system weekly or more often, this is a finding."},{"label":"fix","data":"Configure CouchDB to off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\n\n    Ensure logging is enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000515-DB-000318","gid":"V-58055","rid":"SV-72485r1_rule","stig_id":"SRG-APP-000515-DB-000318","fix_id":null,"cci":["CCI-001851"],"nist":["AU-4 (1)","Rev_4"]},"code":"control \"V-58055\" do\n  title \"The DBMS must off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\"\n  desc  \"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.\n  \"\n  desc  \"check\", \"\n    Review the system documentation for a description of how audit records are\noff-loaded.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep 'syslog_facility'\n    Check with the organization to see how syslog facilities are defined in\ntheir organization.\n\n    If the wrong facility is configured, this is a finding.\n\n    If CouchDB has a continuous network connection to the centralized log\nmanagement system, but CouchDB audit records are not written directly to the\ncentralized log management system or transferred in near-real-time, this is a\nfinding.\n\n    If CouchDB does not have a continuous network connection to the centralized\nlog management system, and CouchDB audit records are not transferred to the\ncentralized log management system weekly or more often, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to off-load audit data to a separate log management\nfacility; this shall be continuous and in near real time for systems with a\nnetwork connection to the storage facility and weekly or more often for\nstand-alone systems.\n\n    Ensure logging is enabled\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000515-DB-000318\"\n  tag \"gid\": \"V-58055\"\n  tag \"rid\": \"SV-72485r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000515-DB-000318\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001851\"]\n  tag \"nist\": [\"AU-4 (1)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.syslog_facility') { should_not be 'nil' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58055.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0440663,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.syslog_facility is expected not to equal \"nil\"","run_time":0.0001468,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58059","title":"The DBMS must provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures. ","desc":"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less).","descriptions":[{"label":"default","data":"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less)."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide an immediate real-time alert\nto appropriate support staff of all audit log failures.\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #grep \"write_delay = \" <path to default.ini>\n    if line does not exist or is not set to 0, this is a finding.\n\n    If it is not set to provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures, this is a finding."},{"label":"fix","data":"Configure CouchDB log records to record an immediate real-time alert to\nappropriate support staff of all audit log failures.\n\n    # find . -name \"default.ini\"\n    # set write_delay = 0"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000360-DB-000320","gid":"V-58059","rid":"SV-72489r2_rule","stig_id":"SRG-APP-000360-DB-000320","fix_id":null,"cci":["CCI-001858"],"nist":["AU-5 (2)","Rev_4"]},"code":"control \"V-58059\" do\n  title \"The DBMS must provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures. \"\n  desc  \"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability, and system operation may be adversely affected.\n\n    The appropriate support staff include, at a minimum, the ISSO and the\nDBA/SA.\n\n    A failure of database auditing will result in either the database\ncontinuing to function without auditing or in a complete halt to database\noperations. When audit processing fails, appropriate personnel must be alerted\nimmediately to avoid further downtime or unaudited transactions.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less).\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide an immediate real-time alert\nto appropriate support staff of all audit log failures.\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #grep \\\"write_delay = \\\" <path to default.ini>\n    if line does not exist or is not set to 0, this is a finding.\n\n    If it is not set to provide an immediate real-time alert to appropriate\nsupport staff of all audit log failures, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB log records to record an immediate real-time alert to\nappropriate support staff of all audit log failures.\n\n    # find . -name \\\"default.ini\\\"\n    # set write_delay = 0\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000360-DB-000320\"\n  tag \"gid\": \"V-58059\"\n  tag \"rid\": \"SV-72489r2_rule\"\n  tag \"stig_id\": \"SRG-APP-000360-DB-000320\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001858\"]\n  tag \"nist\": [\"AU-5 (2)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.write_delay') { should eq '0'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58059.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0437682,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.write_delay is expected to eq \"0\"","run_time":0.0001943,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58063","title":"The DBMS must record time stamps, in audit records and application\ndata, that can be mapped to Coordinated Universal Time (UTC, formerly GMT).","desc":"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.","descriptions":[{"label":"default","data":"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide record time stamps, in audit\nrecords and application data, that can be mapped to Coordinated Universal Time\n(UTC, formerly GMT).\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"writer = \" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to provide record time stamps, in audit records and\napplication data, that can be mapped to Coordinated Universal Time (UTC,\nformerly GMT), this is a finding."},{"label":"fix","data":"If applicable remove or comment out the line writer = journald\nwriter needs to be set equal to file\n\nFile variable needs to be set to path to where log file will be stored.\n# find . -name \"default.ini\"\n#writer = <path to log file>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000374-DB-000322","gid":"V-58063","rid":"SV-72493r1_rule","stig_id":"SRG-APP-000374-DB-000322","fix_id":null,"cci":["CCI-001890"],"nist":["AU-8 b","Rev_4"]},"code":"control \"V-58063\" do\n  title \"The DBMS must record time stamps, in audit records and application\ndata, that can be mapped to Coordinated Universal Time (UTC, formerly GMT).\"\n  desc  \"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to provide record time stamps, in audit\nrecords and application data, that can be mapped to Coordinated Universal Time\n(UTC, formerly GMT).\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"writer = \\\" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to provide record time stamps, in audit records and\napplication data, that can be mapped to Coordinated Universal Time (UTC,\nformerly GMT), this is a finding.\n  \"\n  desc  \"fix\", \"\n    If applicable remove or comment out the line writer = journald\n    writer needs to be set equal to file\n\n    File variable needs to be set to path to where log file will be stored.\n    # find . -name \\\"default.ini\\\"\n    #writer = <path to log file>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000374-DB-000322\"\n  tag \"gid\": \"V-58063\"\n  tag \"rid\": \"SV-72493r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000374-DB-000322\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001890\"]\n  tag \"nist\": [\"AU-8 b\", \"Rev_4\"]\n\n  \n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.writer') { should eq 'journald'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58063.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0440148,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.writer is expected to eq \"journald\"","run_time":0.0001436,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58065","title":"The DBMS must generate time stamps, for audit records and application\ndata, with a minimum granularity of one second.","desc":"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.","descriptions":[{"label":"default","data":"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to generate time stamps, for audit\nrecords and application data, with a minimum granularity of one second.\t\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"writer = \" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to generate time stamps, for audit records and application\ndata, with a minimum granularity of one second, this is a finding."},{"label":"fix","data":"If applicable remove or comment out the line writer = journald\nwriter needs to be set equal to file\nfile variable needs to be set to path to where log file will be stored.\n# set writer = <path to log file>"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000375-DB-000323","gid":"V-58065","rid":"SV-72495r1_rule","stig_id":"SRG-APP-000375-DB-000323","fix_id":null,"cci":["CCI-001889"],"nist":["AU-8 b","Rev_4"]},"code":"control \"V-58065\" do\n  title \"The DBMS must generate time stamps, for audit records and application\ndata, with a minimum granularity of one second.\"\n  desc  \"Without sufficient granularity of time stamps, it is not possible to\nadequately determine the chronological order of records.\n\n    Time stamps generated by the DBMS must include date and time. Granularity\nof time measurements refers to the precision available in time stamp values.\nGranularity coarser than one second is not sufficient for audit trail purposes.\nTime stamp values are typically presented with three or more decimal places of\nseconds; however, the actual granularity may be coarser than the apparent\nprecision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are\npresented to three decimal places, but the granularity is not one millisecond:\nit is about 1/300 of a second.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to generate time stamps, for audit\nrecords and application data, with a minimum granularity of one second.\\t\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"writer = \\\" <path to default.ini>\n    if line is equal to journald, this is a finding.\n\n    If it is not set to generate time stamps, for audit records and application\ndata, with a minimum granularity of one second, this is a finding.\n  \"\n  desc  \"fix\", \"\n    If applicable remove or comment out the line writer = journald\n    writer needs to be set equal to file\n    file variable needs to be set to path to where log file will be stored.\n    # set writer = <path to log file>\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000375-DB-000323\"\n  tag \"gid\": \"V-58065\"\n  tag \"rid\": \"SV-72495r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000375-DB-000323\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001889\"]\n  tag \"nist\": [\"AU-8 b\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n  its('log.writer') { should eq 'journald'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58065.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0445574,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.writer is expected to eq \"journald\"","run_time":0.0001438,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58123","title":"The DBMS must generate audit records for all direct access to the\ndatabase(s).","desc":"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources.","descriptions":[{"label":"default","data":"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources."},{"label":"check","data":"Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for all direct\naccess to the database(s).\n\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log for all direct access to the database(s), this is a\nfinding."},{"label":"fix","data":"Configure CouchDB to enerate audit records for all direct access to the\ndatabase(s).\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000508-DB-000358","gid":"V-58123","rid":"SV-72553r1_rule","stig_id":"SRG-APP-000508-DB-000358","fix_id":null,"cci":["CCI-000172"],"nist":["AU-12 c","Rev_4"]},"code":"control \"V-58123\" do\n  title \"The DBMS must generate audit records for all direct access to the\ndatabase(s).\"\n  desc  \"In this context, direct access is any query, command, or call to the\nDBMS that comes from any source other than the application(s) that it supports.\nExamples would be the command line or a database management utility program.\nThe intent is to capture all activity from administrative and non-standard\nsources.\"\n  desc  \"check\", \"\n    Review the CouchDB database documentation and deployed configuration to\nverify that the database is configured to log audit records for all direct\naccess to the database(s).\n\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to log for all direct access to the database(s), this is a\nfinding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to enerate audit records for all direct access to the\ndatabase(s).\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000508-DB-000358\"\n  tag \"gid\": \"V-58123\"\n  tag \"rid\": \"SV-72553r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000508-DB-000358\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000172\"]\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58123.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0437302,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0001458,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58127","title":"The DBMS must produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the DBMS or\ndatabase(s).","desc":"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.","descriptions":[{"label":"default","data":"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact."},{"label":"check","data":"Review the CouchDB documentation to verify that audit records can produce\naudit records of its enforcement of access restrictions associated with changes\nto the configuration of database(s).\n    # find . -name \"default.ini\"\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \"level =\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the CouchDB\ndatabase, this is a finding."},{"label":"fix","data":"Configure CouchDB to verify that audit records can produce audit records\nof its enforcement of access restrictions associated with changes to the\nconfiguration of database(s).\n\n    # find . -name \"default.ini\"\n    # set level = info"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000381-DB-000361","gid":"V-58127","rid":"SV-72557r1_rule","stig_id":"SRG-APP-000381-DB-000361","fix_id":null,"cci":["CCI-001814"],"nist":["CM-5 (1)","Rev_4"]},"code":"control \"V-58127\" do\n  title \"The DBMS must produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the DBMS or\ndatabase(s).\"\n  desc  \"Without auditing the enforcement of access restrictions against\nchanges to configuration, it would be difficult to identify attempted attacks\nand an audit trail would not be available for forensic investigation for\nafter-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.\n  \"\n  desc  \"check\", \"\n    Review the CouchDB documentation to verify that audit records can produce\naudit records of its enforcement of access restrictions associated with changes\nto the configuration of database(s).\n    # find . -name \\\"default.ini\\\"\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n    #grep \\\"level =\\\" <path to default.ini>\n    if line does not exist or is not set to info, this is a finding.\n\n    If it is not set to produce audit records of its enforcement of access\nrestrictions associated with changes to the configuration of the CouchDB\ndatabase, this is a finding.\n  \"\n  desc  \"fix\", \"\n     Configure CouchDB to verify that audit records can produce audit records\nof its enforcement of access restrictions associated with changes to the\nconfiguration of database(s).\n\n    # find . -name \\\"default.ini\\\"\n    # set level = info\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000381-DB-000361\"\n  tag \"gid\": \"V-58127\"\n  tag \"rid\": \"SV-72557r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000381-DB-000361\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001814\"]\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_4\"]\n\n  describe file(input('couchdb_conf_default')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_default')) do\n    its('log.level') { should eq 'info'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58127.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/default.ini is expected to exist","run_time":0.0435869,"start_time":"2020-07-24T10:58:02-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini log.level is expected to eq \"info\"","run_time":0.0001413,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58137","title":"The DBMS must prohibit the use of cached authenticators after an\norganization-defined time period.","desc":"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.","descriptions":[{"label":"default","data":"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable."},{"label":"check","data":"Review system settings to determine whether the organization-defined limit\nfor cached authentication is implemented.\n    Check for the following:\n\n    # find . -name \"local.ini\"\n\n    #grep couch_httpd_auth section. Verify that the auth_cache_size\nvariable is set to 50 or has a defined limit.\n\n    If it is not implemented, this is a finding."},{"label":"fix","data":"Modify system settings to implement the organization-defined limit on the\nlifetime of cached authenticators.\n    # find . -name \"local.ini\"\n    # grep couch_httpd_auth section <local.ini path>\n    # Set the auth_cache_size variable = 50"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000400-DB-000367","gid":"V-58137","rid":"SV-72567r1_rule","stig_id":"SRG-APP-000400-DB-000367","fix_id":null,"cci":["CCI-002007"],"nist":["IA-5 (13)","Rev_4"]},"code":"control \"V-58137\" do\n  title \"The DBMS must prohibit the use of cached authenticators after an\norganization-defined time period.\"\n  desc  \"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.\"\n  desc  \"check\", \"\n     Review system settings to determine whether the organization-defined limit\nfor cached authentication is implemented.\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n\n    #grep couch_httpd_auth section. Verify that the auth_cache_size\nvariable is set to 50 or has a defined limit.\n\n    If it is not implemented, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Modify system settings to implement the organization-defined limit on the\nlifetime of cached authenticators.\n    # find . -name \\\"local.ini\\\"\n    # grep couch_httpd_auth section <local.ini path>\n    # Set the auth_cache_size variable = 50\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000400-DB-000367\"\n  tag \"gid\": \"V-58137\"\n  tag \"rid\": \"SV-72567r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000400-DB-000367\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002007\"]\n  tag \"nist\": [\"IA-5 (13)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_default')) do\n    its('couch_httpd_auth.auth_cache_size') { cmp 50 }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58137.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini couch_httpd_auth.auth_cache_size ","run_time":0.000133,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58149","title":"The DBMS must prevent unauthorized and unintended information transfer\nvia shared system resources.","desc":"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse.","descriptions":[{"label":"default","data":"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse."},{"label":"check","data":"Review CouchDB architecture to find out if and how it protects the private\nresources of one process or user (such as working memory, temporary tables,\nuncommitted data) from unauthorized access by another user or process.\n    Check for the following:\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If enable is not set to true, this is a finding."},{"label":"fix","data":"Deploy a DBMS capable of effectively protecting the private resources of\none process or user from unauthorized access by another user or process.\n\n    Configure CouchDB to effectively protect the private resources of one\nprocess or user from unauthorized access by another user or process."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000243-DB-000373","gid":"V-58149","rid":"SV-72579r1_rule","stig_id":"SRG-APP-000243-DB-000373","fix_id":null,"cci":["CCI-001090"],"nist":["SC-4","Rev_4"]},"code":"control \"V-58149\" do\n  title \"The DBMS must prevent unauthorized and unintended information transfer\nvia shared system resources.\"\n  desc  \"The purpose of this control is to prevent information, including\nencrypted representations of information, produced by the actions of a prior\nuser/role (or the actions of a process acting on behalf of a prior user/role)\nfrom being available to any current user/role (or current process) that obtains\naccess to a shared system resource (e.g., registers, main memory, secondary\nstorage) after the resource has been released back to the information system.\nControl of information in shared resources is also referred to as object reuse.\"\n  desc  \"check\", \"\n    Review CouchDB architecture to find out if and how it protects the private\nresources of one process or user (such as working memory, temporary tables,\nuncommitted data) from unauthorized access by another user or process.\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If enable is not set to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Deploy a DBMS capable of effectively protecting the private resources of\none process or user from unauthorized access by another user or process.\n\n    Configure CouchDB to effectively protect the private resources of one\nprocess or user from unauthorized access by another user or process.\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000243-DB-000373\"\n  tag \"gid\": \"V-58149\"\n  tag \"rid\": \"SV-72579r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000243-DB-000373\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001090\"]\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58149.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":7.86e-05,"start_time":"2020-07-24T10:58:02-04:00"}]},{"id":"V-58151","title":"Access to database files must be limited to relevant processes and to\nauthorized, administrative users.","desc":"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation.","descriptions":[{"label":"default","data":"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation."},{"label":"check","data":"Review the permissions granted to users by the operating system/file system\non the database files, database log files and database backup files.\n    Check for the following:\n\n    Execute the command #GET /db/_security\n    Verify the admins are authorized, administrative users. If not, this is a\nfinding.\n    # find .-name \"default.ini\"\n    # grep \"admin_only_all_dbs\" default.ini\n    If this is commented out, or not set equal to true, this is a finding."},{"label":"fix","data":"Configure the permissions granted by the operating system/file system on\nthe database files, database log files, and database backup files so that only\nrelevant system accounts and authorized system administrators and database\nadministrators with a need to know are permitted to read/view these files.\n    # find .-name \"default.ini\"\n    # grep \"admin_only_all_dbs\" default.ini"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000243-DB-000374","gid":"V-58151","rid":"SV-72581r1_rule","stig_id":"SRG-APP-000243-DB-000374","fix_id":null,"cci":["CCI-001090"],"nist":["SC-4","Rev_4"]},"code":"control \"V-58151\" do\n  title \"Access to database files must be limited to relevant processes and to\nauthorized, administrative users.\"\n  desc  \"Applications, including DBMSs, must prevent unauthorized and\nunintended information transfer via shared system resources. Permitting only\nDBMS processes and authorized, administrative users to have access to the files\nwhere the database resides helps ensure that those files are not shared\ninappropriately and are not open to backdoor access and manipulation.\"\n  desc  \"check\", \"\n    Review the permissions granted to users by the operating system/file system\non the database files, database log files and database backup files.\n    Check for the following:\n\n    Execute the command #GET /db/_security\n    Verify the admins are authorized, administrative users. If not, this is a\nfinding.\n    # find .-name \\\"default.ini\\\"\n    # grep \\\"admin_only_all_dbs\\\" default.ini\n    If this is commented out, or not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure the permissions granted by the operating system/file system on\nthe database files, database log files, and database backup files so that only\nrelevant system accounts and authorized system administrators and database\nadministrators with a need to know are permitted to read/view these files.\n    # find .-name \\\"default.ini\\\"\n    # grep \\\"admin_only_all_dbs\\\" default.ini\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000243-DB-000374\"\n  tag \"gid\": \"V-58151\"\n  tag \"rid\": \"SV-72581r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000243-DB-000374\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001090\"]\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n\n  describe command('curl -X GET /db/_security') do\n    it { should exist }\n  end\n  describe ini(input('couchdb_conf_default')) do\n      its ('chttpd.admin_only_all_dbs') { should eq 'true'}\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58151.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Command: `curl -X GET /db/_security` is expected to exist","run_time":0.0447948,"start_time":"2020-07-24T10:58:02-04:00","message":"expected Command: `curl -X GET /db/_security` to exist"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/default.ini chttpd.admin_only_all_dbs is expected to eq \"true\"","run_time":0.0001299,"start_time":"2020-07-24T10:58:03-04:00"}]},{"id":"V-58153","title":"The DBMS must maintain the confidentiality and integrity of\ninformation during preparation for transmission.","desc":"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms.","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms."},{"label":"check","data":"Check for the following:\n\n# find . -name \"local.ini\"\n# grep \"ssl section\"\n# grep \"enable =\"\nIf this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000441-DB-000378","gid":"V-58153","rid":"SV-72583r1_rule","stig_id":"SRG-APP-000441-DB-000378","fix_id":null,"cci":["CCI-002420"],"nist":["SC-8 (2)","Rev_4"]},"code":"control \"V-58153\" do\n  title \"The DBMS must maintain the confidentiality and integrity of\ninformation during preparation for transmission.\"\n  desc  \"Information can be either unintentionally or maliciously disclosed or\nmodified during preparation for transmission, including, for example, during\naggregation, at protocol transformation points, and during packing/unpacking.\nThese unauthorized disclosures or modifications compromise the confidentiality\nor integrity of the information.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process.\n\n    When transmitting data, the DBMS, associated applications, and\ninfrastructure must leverage transmission protection mechanisms.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000441-DB-000378\"\n  tag \"gid\": \"V-58153\"\n  tag \"rid\": \"SV-72583r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000441-DB-000378\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002420\"]\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58153.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":8.41e-05,"start_time":"2020-07-24T10:58:03-04:00"}]},{"id":"V-58155","title":"The DBMS must maintain the confidentiality and integrity of\ninformation during reception.","desc":"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms.","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms."},{"label":"check","data":"Check for the following:\n\n# find . -name \"local.ini\"\n# grep \"ssl section\"\n# grep \"enable =\"\nIf this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000442-DB-000379","gid":"V-58155","rid":"SV-72585r1_rule","stig_id":"SRG-APP-000442-DB-000379","fix_id":null,"cci":["CCI-002422"],"nist":["SC-8 (2)","Rev_4"]},"code":"control \"V-58155\" do\n  title \"The DBMS must maintain the confidentiality and integrity of\ninformation during reception.\"\n  desc  \"Information can be either unintentionally or maliciously disclosed or\nmodified during reception, including, for example, during aggregation, at\nprotocol transformation points, and during packing/unpacking. These\nunauthorized disclosures or modifications compromise the confidentiality or\nintegrity of the information.\n\n    This requirement applies only to those applications that are either\ndistributed or can allow access to data nonlocally. Use of this requirement\nwill be limited to situations where the data owner has a strict requirement for\nensuring data integrity and confidentiality is maintained at every step of the\ndata transfer and handling process.\n\n    When receiving data, the DBMS, associated applications, and infrastructure\nmust leverage protection mechanisms.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000442-DB-000379\"\n  tag \"gid\": \"V-58155\"\n  tag \"rid\": \"SV-72585r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000442-DB-000379\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002422\"]\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58155.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":7.53e-05,"start_time":"2020-07-24T10:58:03-04:00"}]},{"id":"V-58157","title":"The DBMS must use NSA-approved cryptography to protect classified\ninformation in accordance with the data owners requirements.","desc":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices."},{"label":"check","data":"If CouchDB is deployed in an unclassified environment, this is not\napplicable (NA).\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000416-DB-000380","gid":"V-58157","rid":"SV-72587r1_rule","stig_id":"SRG-APP-000416-DB-000380","fix_id":null,"cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58157\" do\n  title \"The DBMS must use NSA-approved cryptography to protect classified\ninformation in accordance with the data owners requirements.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    NSA-approved cryptography for classified networks is hardware based. This\nrequirement addresses the compatibility of a DBMS with the encryption devices.\n  \"\n  desc  \"check\", \"\n    If CouchDB is deployed in an unclassified environment, this is not\napplicable (NA).\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000416-DB-000380\"\n  tag \"gid\": \"V-58157\"\n  tag \"rid\": \"SV-72587r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000416-DB-000380\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58157.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":7.13e-05,"start_time":"2020-07-24T10:58:03-04:00"}]},{"id":"V-58163","title":"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to protect unclassified information requiring confidentiality and\ncryptographic protection, in accordance with the data owners requirements.","desc":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.","descriptions":[{"label":"default","data":"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant."},{"label":"check","data":"Check for the following:\n# find . -name \"local.ini\"\n\n# cat /proc/sys/crypto/fips_enabled\nVerify that the response of fips_enabled is 1.\n\nIf it is not 1 , this is a finding."},{"label":"fix","data":"Configure OpenSSL to be FIPS compliant.\n# sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000514-DB-000383","gid":"V-58163","rid":"SV-72593r1_rule","stig_id":"SRG-APP-000514-DB-000383","fix_id":null,"cci":["CCI-002450"],"nist":["SC-13","Rev_4"]},"code":"control \"V-58163\" do\n  title \"The DBMS must implement NIST FIPS 140-2 validated cryptographic\nmodules to protect unclassified information requiring confidentiality and\ncryptographic protection, in accordance with the data owners requirements.\"\n  desc  \"Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The application must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.\n\n    It is the responsibility of the data owner to assess the cryptography\nrequirements in light of applicable federal laws, Executive Orders, directives,\npolicies, regulations, and standards.\n\n    For detailed information, refer to NIST FIPS Publication 140-2, Security\nRequirements For Cryptographic Modules. Note that the product's cryptographic\nmodules must be validated and certified by NIST as FIPS-compliant.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n    # find . -name \\\"local.ini\\\"\n\n    # cat /proc/sys/crypto/fips_enabled\n    Verify that the response of fips_enabled is 1.\n\n    If it is not 1 , this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure OpenSSL to be FIPS compliant.\n    # sed -i 's/0/1/g' /proc/sys/crypto/fips_enabled\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000514-DB-000383\"\n  tag \"gid\": \"V-58163\"\n  tag \"rid\": \"SV-72593r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000514-DB-000383\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n\n  describe command('cat /proc/sys/crypto/fips_enabled') do\n    \n    end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58163.rb"},"waiver_data":{},"results":[]},{"id":"V-58165","title":"The DBMS must maintain the authenticity of communications sessions by\nguarding against man-in-the-middle attacks that guess at Session ID values.","desc":"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective.","descriptions":[{"label":"default","data":"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective."},{"label":"check","data":"Review DBMS vendor documentation and system behavior (and if necessary,\nconsult vendor representatives) to determine whether CouchDB can provide\ndemonstrably effective protection against man-in-the-middle attacks that guess\nat session identifier values.\n\n    Review DBMS settings to determine whether protections against\nman-in-the-middle attacks that guess at session identifier values are enabled.\n\n    # find . -name \"local.ini\"\n    # grep \"ssl section\"\n    # grep \"enable =\"\n    If this is not set equal to true, this is a finding."},{"label":"fix","data":"Configure CouchDB to use SSL\n# find . -name \"local.ini\"\n# set \"enable=true\""}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000224-DB-000384","gid":"V-58165","rid":"SV-72595r1_rule","stig_id":"SRG-APP-000224-DB-000384","fix_id":null,"cci":["CCI-001188"],"nist":["SC-23 (3)","Rev_4"]},"code":"control \"V-58165\" do\n  title \"The DBMS must maintain the authenticity of communications sessions by\nguarding against man-in-the-middle attacks that guess at Session ID values.\"\n  desc  \"One class of man-in-the-middle, or session hijacking, attack involves\nthe adversary guessing at valid session identifiers based on patterns in\nidentifiers already known.\n\n    The preferred technique for thwarting guesses at Session IDs is the\ngeneration of unique session identifiers using a FIPS 140-2 approved random\nnumber generator.\n\n    However, it is recognized that available DBMS products do not all implement\nthe preferred technique yet may have other protections against session\nhijacking. Therefore, other techniques are acceptable, provided they are\ndemonstrated to be effective.\n  \"\n  desc  \"check\", \"\n     Review DBMS vendor documentation and system behavior (and if necessary,\nconsult vendor representatives) to determine whether CouchDB can provide\ndemonstrably effective protection against man-in-the-middle attacks that guess\nat session identifier values.\n\n    Review DBMS settings to determine whether protections against\nman-in-the-middle attacks that guess at session identifier values are enabled.\n\n    # find . -name \\\"local.ini\\\"\n    # grep \\\"ssl section\\\"\n    # grep \\\"enable =\\\"\n    If this is not set equal to true, this is a finding.\n  \"\n  desc  \"fix\", \"\n    Configure CouchDB to use SSL\n    # find . -name \\\"local.ini\\\"\n    # set \\\"enable=true\\\"\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000224-DB-000384\"\n  tag \"gid\": \"V-58165\"\n  tag \"rid\": \"SV-72595r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000224-DB-000384\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-001188\"]\n  tag \"nist\": [\"SC-23 (3)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n  end\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58165.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":8.88e-05,"start_time":"2020-07-24T10:58:03-04:00"}]},{"id":"V-58167","title":"The DBMS must only accept end entity certificates issued by DoD PKI or\nDoD-approved PKI Certification Authorities (CAs) for the establishment of all\nencrypted sessions.","desc":"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet.","descriptions":[{"label":"default","data":"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet."},{"label":"check","data":"Check for the following:\n    # find . -name \"local.ini\"\n\n    #grep ssl section\n    Verify \"enabled = true\"\n    #grep \"cert_file = /etc/couchdb/cert/couchdb.pem\"\n    Verify for certificates issued by DoD PKI or DoD-approved PKI Certification\nAuthorities (CAs)\n\n    If CouchDB will accept non-DoD approved PKI end-entity certificates, this\nis a finding"},{"label":"fix","data":"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority. Configure CouchDB to accept only DoD and DoD-approved\nPKI end-entity certificates."}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000427-DB-000385","gid":"V-58167","rid":"SV-72597r1_rule","stig_id":"SRG-APP-000427-DB-000385","fix_id":null,"cci":["CCI-002470"],"nist":["SC-23 (5)","Rev_4"]},"code":"control \"V-58167\" do\n  title \"The DBMS must only accept end entity certificates issued by DoD PKI or\nDoD-approved PKI Certification Authorities (CAs) for the establishment of all\nencrypted sessions.\"\n  desc  \"Only DoD-approved external PKIs have been evaluated to ensure that\nthey have security controls and identity vetting procedures in place which are\nsufficient for DoD systems to rely on the identity asserted in the certificate.\n PKIs lacking sufficient security controls and identity vetting procedures risk\nbeing compromised and issuing certificates that enable adversaries to\nimpersonate legitimate users.\n\n    The authoritative list of DoD-approved PKIs is published at\nhttp://iase.disa.mil/pki-pke/interoperability.\n\n    This requirement focuses on communications protection for the DBMS session\nrather than for the network packet.\n  \"\n  desc  \"check\", \"\n    Check for the following:\n    # find . -name \\\"local.ini\\\"\n\n    #grep ssl section\n    Verify \\\"enabled = true\\\"\n    #grep \\\"cert_file = /etc/couchdb/cert/couchdb.pem\\\"\n    Verify for certificates issued by DoD PKI or DoD-approved PKI Certification\nAuthorities (CAs)\n\n    If CouchDB will accept non-DoD approved PKI end-entity certificates, this\nis a finding\n  \"\n  desc  \"fix\", \"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority. Configure CouchDB to accept only DoD and DoD-approved\nPKI end-entity certificates.\"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000427-DB-000385\"\n  tag \"gid\": \"V-58167\"\n  tag \"rid\": \"SV-72597r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000427-DB-000385\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002470\"]\n  tag \"nist\": [\"SC-23 (5)\", \"Rev_4\"]\n\n  describe ini(input('couchdb_conf_local')) do\n    its('ssl.enable') { should eq 'true' }\n    its('ssl.cert_file') {should eq '/etc/couchdb/cert/couchdb.pem'}\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58167.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.enable is expected to eq \"true\"","run_time":0.0001166,"start_time":"2020-07-24T10:58:03-04:00"},{"status":"failed","code_desc":"INI /opt/couchdb/etc/local.ini ssl.cert_file is expected to eq \"/etc/couchdb/cert/couchdb.pem\"","run_time":0.0001868,"start_time":"2020-07-24T10:58:03-04:00","message":"\nexpected: \"/etc/couchdb/cert/couchdb.pem\"\n     got: \"/full/path/to/server_cert.pem\"\n\n(compared using ==)\n"}]},{"id":"V-58177","title":"Security-relevant software updates to the DBMS must be installed\nwithin the time period directed by an authoritative source (e.g. IAVM, CTOs,\nDTMs, and STIGs).","desc":"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).","descriptions":[{"label":"default","data":"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs)."},{"label":"check","data":"Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    Execute the following in the command line: curl [http address]\n    Verify the version is the most recent version"},{"label":"fix","data":"Update version of CouchDB"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000456-DB-000390","gid":"V-58177","rid":"SV-72607r1_rule","stig_id":"SRG-APP-000456-DB-000390","fix_id":null,"cci":["CCI-002605"],"nist":["SI-2 c","Rev_4"]},"code":"control \"V-58177\" do\n  title \"Security-relevant software updates to the DBMS must be installed\nwithin the time period directed by an authoritative source (e.g. IAVM, CTOs,\nDTMs, and STIGs).\"\n  desc  \"Security flaws with software applications, including database\nmanagement systems, are discovered daily. Vendors are constantly updating and\npatching their products to address newly discovered security vulnerabilities.\nOrganizations (including any contractor to the organization) are required to\npromptly install security-relevant software updates (e.g., patches, service\npacks, and hot fixes). Flaws discovered during security assessments, continuous\nmonitoring, incident response activities, or information system error handling\nmust also be addressed expeditiously.\n\n    Organization-defined time periods for updating security-relevant software\nmay vary based on a variety of factors including, for example, the security\ncategory of the information system or the criticality of the update (i.e.,\nseverity of the vulnerability related to the discovered flaw).\n\n    This requirement will apply to software patch management solutions that are\nused to install patches across the enclave and also to applications themselves\nthat are not part of that patch management solution. For example, many browsers\ntoday provide the capability to install their own patch software. Patch\ncriticality, as well as system criticality, will vary. Therefore, the tactical\nsituations regarding the patch management process will also vary. This means\nthat the time period utilized must be a configurable parameter. Time frames for\napplication of security-relevant software updates may be dependent upon the\nInformation Assurance Vulnerability Management (IAVM) process.\n\n    The application will be configured to check for and install\nsecurity-relevant software updates within an identified time period from the\navailability of the update. The specific time period will be defined by an\nauthoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).\n  \"\n  desc  \"check\", \"\n    Obtain evidence that software patches are consistently applied to CouchDB\nwithin the time frame defined for each patch.\n\n    Execute the following in the command line: curl [http address]\n    Verify the version is the most recent version\n  \"\n  desc  \"fix\", 'Update version of CouchDB'\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000456-DB-000390\"\n  tag \"gid\": \"V-58177\"\n  tag \"rid\": \"SV-72607r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000456-DB-000390\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-002605\"]\n  tag \"nist\": [\"SI-2 c\", \"Rev_4\"]\n\n  describe command('curl http://127.0.0.1:5984/') do \n    its('stdout') { should include 'version' }\n    its('version') { should cmp >= '1.3.1' }\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58177.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Command: `curl http://127.0.0.1:5984/` stdout is expected to include \"version\"","run_time":0.0832872,"start_time":"2020-07-24T10:58:03-04:00"},{"status":"failed","code_desc":"Command: `curl http://127.0.0.1:5984/` version ","run_time":0.0001704,"start_time":"2020-07-24T10:58:03-04:00","message":"undefined method `version' for #<#<Class:0x000000000a0bf928>:0x000000000fc78c88>","exception":"NoMethodError","backtrace":["C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:134:in `block (3 levels) in its'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:133:in `each'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:133:in `inject'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:133:in `block (2 levels) in its'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:317:in `block (2 levels) in let'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:157:in `block (3 levels) in fetch_or_store'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:157:in `fetch'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:157:in `block (2 levels) in fetch_or_store'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-support-3.9.3/lib/rspec/support/reentrant_mutex.rb:23:in `synchronize'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:156:in `block in fetch_or_store'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:155:in `fetch'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:155:in `fetch_or_store'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/memoized_helpers.rb:317:in `block in let'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-its-1.3.0/lib/rspec/its.rb:159:in `should'","C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-58177.rb:56:in `block (3 levels) in load_with_context'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.21.1/lib/inspec/runner_rspec.rb:82:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.21.1/lib/inspec/runner.rb:159:in `run_tests'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-4.21.1/lib/inspec/runner.rb:130:in `run'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/kitchen-inspec-2.0.0/lib/kitchen/verifier/inspec.rb:105:in `call'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:459:in `block in verify_action'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:552:in `synchronize_or_call'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:514:in `block in action'","C:/opscode/chef-workstation/embedded/lib/ruby/2.7.0/benchmark.rb:293:in `measure'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:513:in `action'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:451:in `verify_action'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:382:in `block (2 levels) in transition_to'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/lifecycle_hooks.rb:45:in `run_with_hooks'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:381:in `block in transition_to'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:380:in `each'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:380:in `transition_to'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/instance.rb:162:in `verify'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/command.rb:198:in `public_send'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/command.rb:198:in `run_action_in_thread'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/test-kitchen-2.5.2/lib/kitchen/command.rb:169:in `block (2 levels) in run_action'","C:/opscode/chef-workstation/embedded/lib/ruby/gems/2.7.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}]},{"id":"V-61407","title":"If DBMS authentication, using passwords, is employed, the DBMS must\nenforce the DoD standards for password complexity and lifetime.","desc":"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code.","descriptions":[{"label":"default","data":"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code."},{"label":"check","data":"Review CouchDB settings relating to password complexity. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n\n    Review CouchDB settings relating to password lifetime. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n    # find . -name \"default.ini\"\n\n    # grep \"file =\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n\n    Verify that the password follows the PBKDF2 (RFC-2898) algorithm"},{"label":"fix","data":"Restart the CouchDB services.\n# sudo restart couchdb"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000164-DB-000401","gid":"V-61407","rid":"SV-75897r3_rule","stig_id":"SRG-APP-000164-DB-000401","fix_id":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)","Rev_4"]},"code":"control \"V-61407\" do\n  title \"If DBMS authentication, using passwords, is employed, the DBMS must\nenforce the DoD standards for password complexity and lifetime.\"\n  desc  \"OS/enterprise authentication and identification must be used\n(SRG-APP-000023-DB-000001).  Native DBMS authentication may be used only when\ncircumstances make it unavoidable; and must be documented and AO-approved.\n\n    The DoD standard for authentication is DoD-approved PKI certificates.\nAuthentication based on User ID and Password may be used only when it is not\npossible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, the DoD standards for password complexity and lifetime must\nbe implemented.  DBMS products that can inherit the rules for these from the\noperating system or access control program (e.g., Microsoft Active Directory)\nmust be configured to do so.  For other DBMSs, the rules must be enforced using\navailable configuration parameters or custom code.\n  \"\n  desc  \"check\", \"\n    Review CouchDB settings relating to password complexity. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n\n    Review CouchDB settings relating to password lifetime. Determine whether\nthe following rules are enforced. If any are not, this is a finding.\n\n    # find . -name \\\"default.ini\\\"\n\n    # grep \\\"file =\\\" <path to default.ini>\n    if line does not exist or is commented out, this is a finding.\n\n    #cat <path to local.ini>\n    Review this file for users along with passwords. It can be seen in the\nfollowing format:\n\n    admin =\n-pbkdf2-71c01cb429088ac1a1e95f3482202622dc1e53fe,226701bece4ae0fc9a373a5e02bf5d07,10\n\n\n    Verify that the password follows the PBKDF2 (RFC-2898) algorithm\n\n  \"\n  desc  \"fix\", \"\n    Restart the CouchDB services.\n    # sudo restart couchdb\n  \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"gtitle\": \"SRG-APP-000164-DB-000401\"\n  tag \"gid\": \"V-61407\"\n  tag \"rid\": \"SV-75897r3_rule\"\n  tag \"stig_id\": \"SRG-APP-000164-DB-000401\"\n  tag \"fix_id\": nil\n  tag \"cci\": [\"CCI-000192\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n\n  \n  describe file(input('couchdb_conf_local')) do\n    it { should exist }\n  end\n\n  describe ini(input('couchdb_conf_local')) do\n    its('admins.admin') { should match '-pbkdf2-' }\n  end\n\nend\n","source_location":{"line":3,"ref":"C:/Users/zhangc/git/apache-couchdb-srg-baseline/controls/V-61407.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /opt/couchdb/etc/local.ini is expected to exist","run_time":0.045076,"start_time":"2020-07-24T10:58:03-04:00"},{"status":"passed","code_desc":"INI /opt/couchdb/etc/local.ini admins.admin is expected to match \"-pbkdf2-\"","run_time":0.0001541,"start_time":"2020-07-24T10:58:03-04:00"}]}],"status":"loaded"}],"statistics":{"duration":0.7340056},"version":"4.21.1"}